!function t(e,i,s){function r(n,a){if(!i[n]){if(!e[n]){var l="function"==typeof require&&require;if(!a&&l)return l(n,!0);if(o)return o(n,!0);throw new Error("Cannot find module '"+n+"'")}var d=i[n]={exports:{}};e[n][0].call(d.exports,function(t){var i=e[n][1][t];return r(i||t)},d,d.exports,t,e,i,s)}return i[n].exports}for(var o="function"==typeof require&&require,n=0;n<s.length;n++)r(s[n]);return r}({1:[function(t,e,i){(function(t){"use strict";function i(){d=!0;for(var t,e,i=c.length;i;){for(e=c,c=[],t=-1;++t<i;)e[t]();i=c.length}d=!1}var s,r=t.MutationObserver||t.WebKitMutationObserver;if(r){var o=0,n=new r(i),a=t.document.createTextNode("");n.observe(a,{characterData:!0}),s=function(){a.data=o=++o%2}}else if(t.setImmediate||void 0===t.MessageChannel)s="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){i(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(i,0)};else{var l=new t.MessageChannel;l.port1.onmessage=i,s=function(){l.port2.postMessage(0)}}var d,c=[];e.exports=function(t){1!==c.push(t)||d||s()}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,i){"use strict";function s(){}function r(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,t!==s&&l(this,t)}function o(t,e,i){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof i&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}function n(t,e,i){c(function(){var s;try{s=e(i)}catch(e){return h.reject(t,e)}s===t?h.reject(t,new TypeError("Cannot resolve promise with itself")):h.resolve(t,s)})}function a(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function l(t,e){function i(e){r||(r=!0,h.reject(t,e))}function s(e){r||(r=!0,h.resolve(t,e))}var r=!1,o=d(function(){e(s,i)});"error"===o.status&&i(o.value)}function d(t,e){var i={};try{i.value=t(e),i.status="success"}catch(t){i.status="error",i.value=t}return i}var c=t("immediate"),h={},p=["REJECTED"],u=["FULFILLED"],m=["PENDING"];e.exports=r,r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,e){if("function"!=typeof t&&this.state===u||"function"!=typeof e&&this.state===p)return this;var i=new this.constructor(s);return this.state!==m?n(i,this.state===u?t:e,this.outcome):this.queue.push(new o(i,t,e)),i},o.prototype.callFulfilled=function(t){h.resolve(this.promise,t)},o.prototype.otherCallFulfilled=function(t){n(this.promise,this.onFulfilled,t)},o.prototype.callRejected=function(t){h.reject(this.promise,t)},o.prototype.otherCallRejected=function(t){n(this.promise,this.onRejected,t)},h.resolve=function(t,e){var i=d(a,e);if("error"===i.status)return h.reject(t,i.value);var s=i.value;if(s)l(t,s);else{t.state=u,t.outcome=e;for(var r=-1,o=t.queue.length;++r<o;)t.queue[r].callFulfilled(e)}return t},h.reject=function(t,e){t.state=p,t.outcome=e;for(var i=-1,s=t.queue.length;++i<s;)t.queue[i].callRejected(e);return t},r.resolve=function(t){return t instanceof this?t:h.resolve(new this(s),t)},r.reject=function(t){var e=new this(s);return h.reject(e,t)},r.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var i=t.length,r=!1;if(!i)return this.resolve([]);for(var o=new Array(i),n=0,a=-1,l=new this(s);++a<i;)!function(t,s){e.resolve(t).then(function(t){o[s]=t,++n!==i||r||(r=!0,h.resolve(l,o))},function(t){r||(r=!0,h.reject(l,t))})}(t[a],a);return l},r.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var i=t.length,r=!1;if(!i)return this.resolve([]);for(var o=-1,n=new this(s);++o<i;)!function(t){e.resolve(t).then(function(t){r||(r=!0,h.resolve(n,t))},function(t){r||(r=!0,h.reject(n,t))})}(t[o]);return n}},{immediate:1}],3:[function(t,e,i){function s(t){this.ads_last=[],this.calcControlCnt=110,this.noTrailer=0,this.Pid=0,this.repeat=0,this.root_src=0,this.blockId=0,this.sControl=0,this.exitFlag=0,this.secondRound=0,this.Bloks=[],this.exitFrame=0,this.BlocksPlayed={},this.currentIdBloks=-1,this.StartInd=-1,this.PlayStatus=0,this.cacheCascade={},this.cachePlay={},this.referer=window.location.href,this.referer_host=window.location.hostname,this.trailerTime=0,this.slot=t||this.createSlot(),this.GlobalMyGUITemp="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}),this.IntStab=null}var r=t("./Client"),o=t("./BridgeClient"),n=t("./PseudoClient"),a=t("./VideorollClient"),l=t("./Statistic"),d=t("./util/UTILS").isMobile,c=t("./util/UTILS").repareUrl;s.prototype.drowSlot=function(t){0==t.width?(this.slot.style.width="100%",this.slot.style.minWidth="550px"):this.slot.style.width=t.width+"px",0==t.height?(this.slot.style.height="100%",this.slot.style.minHeight="340px"):this.slot.style.height=t.height+"px",this.sControl=t.control},s.prototype.drowControl=function(){var t=document.createElement("DIV");t.style.position="absolute",t.style.top="calc(50% - 25px)",t.style.right="10px",t.style.opacity="0.5",t.style.filter="alpha(Opacity=50)",t.style.color="#FFFFFF",t.style.zIndex="4500",t.className="lastController",t.style.width="50px",t.style.height="50px";var e=document.createElement("DIV");e.style.display="block",e.style.marginLeft="5px",e.fontSize="12px";var i=document.createElement("DIV");i.style.marginLeft="5px",i.style.backgroundImage="url(//apptoday.ru/ug/img/exit.png) ",i.style.backgroundRepeat="no-repeat",i.style.backgroundSize="contain",i.style.content="",i.className="hover_button",i.title="закрыть рекламу",i.style.cursor="pointer",i.style.display="block",i.style.width="100%",i.style.height="100%",this.slot.style.position="relative",t.appendChild(i),this.slot.appendChild(t),i.onclick=function(){this.Bloks=[],this.exitFrame=1;var t={page_key:this.GlobalMyGUITemp,event:"myButtonClose",id_src:0,block:this.blockId,control:this.sControl,pid:this.Pid,is_mobile:0};l(t),this.slot.innerHTML="",this.slot.style.display="none",this.stopBlock(),this.slot.parentNode.removeChild(this.slot)}.bind(this)},s.prototype.calcControl=function(t){this.calcControlCnt=t},s.prototype.calcStart=function(t){this.IntStab=setInterval(function(){if(t<0)return clearInterval(this.IntStab),this.IntStab=null,void this.drowControl();t--}.bind(this),1e3)},s.prototype.stopBlock=function(){var t=0;for(var e in this.BlocksPlayed)t++;if(this.currentIdBloks++,"function"!=typeof this.SubscribeVAST&&"function"!=typeof this.SubscribeOut&&t)if(this.checkPlayedStatus()){i={page_key:this.GlobalMyGUITemp,event:"myLate",id_src:0,block:this.blockId,control:this.sControl,pid:this.Pid,is_mobile:0};l(i)}else{var i={page_key:this.GlobalMyGUITemp,event:"myBk",id_src:0,block:this.blockId,control:this.sControl,pid:this.Pid,is_mobile:0};l(i)}if(!this.checkPlayedStatus()){if(console.log(["change M",t,this.repeat]),t||this.repeat){if(void 0!==this.Bloks[this.currentIdBloks])return void this.StartBlocks(this.currentIdBloks)}else{if("function"!=typeof this.SubscribeVAST&&this.ads_last.length>0&&this.StartInd>-2)return this.fillBlock(this.ads_last),this.StartInd=-2,this.currentIdBloks=this.Bloks.length-1,void this.StartBlocks(this.currentIdBloks);if(-2==this.StartInd)return}this.exitFlag=1,"function"!=typeof this.SubscribeVAST?"function"!=typeof this.SubscribeOut?this.stopCondition():this.SubscribeOut({event:"END_BLOCK"}):this.SubscribeVAST({event:"END_BLOCK"})}},s.prototype.fillBlock=function(t,e){var e=e||0,i=this.Bloks.length;this.Bloks[i]={stack:[],hash:{}};for(var s=0,r=t.length;s<r;s++){var o=t[s].hasOwnProperty("cheap")?t[s].cheap:0;o||(o=0);var n=t[s].hasOwnProperty("player")?t[s].player:0;n||(n=0);var a=t[s].hasOwnProperty("frame")?t[s].frame:"",l=t[s].hasOwnProperty("partner_script")?t[s].partner_script:"",d=t[s].hasOwnProperty("lasti")?t[s].lasti:0;console.log(["new entry",t[s].id]),this.Bloks[i].hash[t[s].id]={id:t[s].id,lasti:d,title:t[s].title,src:t[s].src,status:0,player:n,cheap:o,frame:a,psc:l,second:e},this.Bloks[i].stack.push(t[s].id)}},s.prototype.StartBlocks=function(t){this.currentIdBloks=t,this.DispatchQueue(this.StartInd)},s.prototype.DispatchQueue=function(t){this.cacheCascade.hasOwnProperty(this.currentIdBloks)||(this.cacheCascade[this.currentIdBloks]={}),this.cacheCascade[this.currentIdBloks].hasOwnProperty(t)?console.log(["oll-ready",t,this.currentIdBloks]):(this.cacheCascade[this.currentIdBloks][t]=1,this.nextLink(this.currentIdBloks))},s.prototype.checkPlayedStatus=function(){if(!this.cachePlay.hasOwnProperty(this.currentIdBloks))return 0;for(var t in this.cachePlay[this.currentIdBloks])if(this.cachePlay[this.currentIdBloks][t])return 1;return 0},s.prototype.setPlayedStatus=function(t,e){this.cachePlay.hasOwnProperty(this.currentIdBloks)||(this.cachePlay[this.currentIdBloks]={}),this.cachePlay[this.currentIdBloks][t]=e},s.prototype.changeLink=function(t){console.log([t,"change all",t]),this.setPlayedStatus(t,0),this.DispatchQueue(t)},s.prototype.nextLink=function(t){if(this.currentIdBloks==t)if(this.checkPlayedStatus())setTimeout(function(){this.nextLink(t)}.bind(this),300);else{if(this.Bloks.hasOwnProperty(t)&&this.Bloks[t].stack.length){var e=this.Bloks[t].stack.shift();if(e&&e>0)return void this.PlayLink(e)}this.stopBlock()}else{this.GlobalMyGUITemp,this.blockId,this.sControl,this.Pid;console.log(["change stop"])}},s.prototype.PlayLink=function(t){if(!this.checkPlayedStatus()){this.Bloks[this.currentIdBloks].hash.hasOwnProperty(t)||this.changeLink(t),this.setPlayedStatus(t,1);var e=this.referer;switch(this.Bloks[this.currentIdBloks].hash[t].player){case 8:(i=new a(this.slot,"https://apptoday.ru/frames/tvigle.html")).playerType="HTML";break;case 5:i=new n(this.slot);break;case 7:(i=new n(this.slot)).StartClick="_272686235544";break;case 6:(i=new n(this.slot)).StartClick="_043411077744";break;case 3:i=new o(this.slot,"//apptoday.ru/frames/inline.html");break;case 2:i=new o(this.slot,"//i-trailer.ru/player/html5/osipov/autonew.html");break;case 1:i=new o(this.slot,"https://kinodrevo.ru/frames/inline.html");break;case 14:i=new a(this.slot,"https://apptoday.ru/frames/videoroll.html");break;case 15:i=new a(this.slot,"https://mp.vidlent.ru/frames/megogo.html");break;case 16:i=new a(this.slot,"//video.kinodrevo.ru/frames/adv.html");break;default:var i=new r(this.slot)}var s=this.Bloks[this.currentIdBloks].hash[t].psc;i.pscC=s;var h=this.Bloks[this.currentIdBloks].hash[t].src,p=c(this.Bloks[this.currentIdBloks].hash[t].src,{referer:e});if("function"==typeof this.SubscribeOut&&(i.SubscribeOut=function(t){this.SubscribeOut(t)}.bind(this)),"function"==typeof this.SubscribeVAST&&(i.SubscribeVAST=function(t){this.SubscribeVAST(t)}.bind(this)),i.id=this.Bloks[this.currentIdBloks].hash[t].id,i.second=this.Bloks[this.currentIdBloks].hash[t].second,i.orig=h,d()?i.is_Mobile=1:i.is_Mobile=0,i.lasti=this.Bloks[this.currentIdBloks].hash[t].lasti,i.blockId=this.blockId,i.title=this.Bloks[this.currentIdBloks].hash[t].title,i.GlobalMyGUITemp=this.GlobalMyGUITemp,i.Pid=this.Pid,i.root_src=this.root_src,i.sControl=this.sControl,i.subscribe(function(e){return this.changeLink(t)},"AdError",this),"function"==typeof this.SubscribeOut);else{var u={page_key:this.GlobalMyGUITemp,event:"request",id_src:i.id,block:this.blockId,control:this.sControl,pid:this.Pid,is_mobile:i.is_Mobile};l(u)}i.FetchData(p).then(function(e){i.subscribe(function(t){this.exitFrame?i.stop():(console.log(["Change MK"]),this.BlocksPlayed[i.id]=1,this.calcControlCnt>0&&(this.calcStart(this.calcControlCnt),this.calcControlCnt=0))},"AdVideoStart",this),i.play().then(function(){i.subscribe(function(e){return this.changeLink(t)},"AdStopped",this),i.subscribe(function(e){return this.changeLink(t)},"stop",this),i.subscribe(function(e){return this.changeLink(t)},"AdSkipped",this)}.bind(this)).catch(function(t){}.bind(this))}.bind(this)).catch(function(e){return this.changeLink(t)}.bind(this))}},s.prototype.stopCondition=function(){var t=0;for(var e in this.BlocksPlayed)t++;t&&0==this.noTrailer?this.playTrailer():this.deleteSlot()},s.prototype.playTrailer=function(){if(this.trailerTime||this.exitFrame)this.deleteSlot();else{console.log(["igr",this.trailerTime]);var t={page_key:this.GlobalMyGUITemp,event:"myTrailer",id_src:0,block:this.blockId,control:this.sControl,pid:this.Pid,is_mobile:0};l(t);var e=this.slot.appendChild(document.createElement("div"));e.id="mp-video-player",e.className="mp-video-player";var i=e.appendChild(document.createElement("video"));if(i.canPlayType("video/mp4")){i.style.display="block",i.controls=!0,i.autoplay=!0,i.style.width=this.slot.style.width,i.style.height=this.slot.style.height;var s=document.createElement("source");s.type="video/mp4",s.src="https://video.market-place.su/mp4/ivancarevichiseryjvolk3m.mp4",i.appendChild(s),i.volume=0,i.load(),i.onended=function(){this.deleteSlot()}.bind(this),i.addEventListener("loadeddata",function(){var t={page_key:this.GlobalMyGUITemp,event:"myTrailerLoaded",id_src:0,block:this.blockId,control:this.sControl,pid:this.Pid,is_mobile:0};l(t)}.bind(this),!1),i.addEventListener("error",function(){var t={page_key:this.GlobalMyGUITemp,event:"myTrailerError",id_src:0,block:this.blockId,control:this.sControl,pid:this.Pid,is_mobile:0};l(t)}.bind(this),!1),this.trailerTime=1}else this.deleteSlot()}},s.prototype.createSlot=function(){var t=document.createElement("DIV");return document.body.appendChild(t),t},s.prototype.deleteSlot=function(t){this.slot&&this.slot.parentNode&&this.slot.parentNode.removeChild(this.slot)},e.exports=s},{"./BridgeClient":4,"./Client":5,"./PseudoClient":6,"./Statistic":7,"./VideorollClient":9,"./util/UTILS":13}],4:[function(t,e,i){"use strict";function s(t,e){this.slot=t,this.blockId=0,this.parameters={slot:t,version:"2.0"},this.id=0,this.timeOutHandler=null,this.title="Никак",this.mediaPlayer=null,this.subscribers={},this.flags={},this.flags.paused=!1,this.flags.started=!1,this.flags.stopped=!1,this.medyaFile={type:"",file:""},this.eventCounter=0,this.FrameSrc=e}t("./util/XML"),t("./util//VideoEvent");var r=t("./util//VPAIDEvent"),o=(t("./util//loadEvents"),t("./Statistic")),n=t("./util/players/BridgePlayer"),a=(t("./util/UTILS").getNextBlockUrl,t("lie"));s.prototype.subscribe=function(t,e,i){"string"==typeof e&&(e=[e]);for(var s=0,r=e.length;s<r;s++){var o=e[s];this.subscribers[o]||(this.subscribers[o]=[]),this.subscribers[o].push({fn:t,ctx:i||null})}},s.prototype.unsubscribe=function(t,e){"string"==typeof e&&(e=[e]);for(var i=e.length;i>=0;i--){var s=this.subscribers[e[i]];if(s&&Array.isArray(s)&&s.length)for(var r=0,o=s.length;r<o;r++)s[r].fn===t&&s.splice(r,1)}},s.prototype.stop=function(){this.mediaPlayer&&(this.mediaPlayer.stop(),delete this.mediaPlayer)},s.prototype.play=function(){return new a(function(t,e){this.mediaPlayer?(this.mediaPlayer.play(),this.slot.style.backgroundColor="#000000",t()):e(["error mediaPlayer",{}])}.bind(this))},s.prototype.FetchData=function(t){function e(t){t.data=t.data||{};var e=t.type,s={page_key:this.GlobalMyGUITemp,event:t.type+" ))",id_src:this.id,block:this.blockId,pid:this.Pid,e1:e};if(e){switch(e){case"AdLoaded":case"AdStarted":case"AdVideoStart":case"AdImpression":case"AdVideoFirstQuartile":case"AdVideoMidpoint":case"AdVideoThirdQuartile":case"AdVideoComplete":case"AdClickThru":case"AdViewable":case"click":s={page_key:this.GlobalMyGUITemp,event:e,id_src:this.id,block:this.blockId,control:this.sControl,pid:this.Pid,is_mobile:this.is_Mobile,second:this.second};o(s)}i.call(this,new r(r.convertFromVAST(t.type),t.data))}}function i(t){(this.subscribers[t.type]||[]).forEach(function(e){e.fn.call(e.ctx,t)})}return new a(function(i,s){this.timeOutHandler=setTimeout(function(){this.stop(),s({status:"timeout 9 sek"})}.bind(this),12e3),this.medyaFile.type="Bridge",this.mediaPlayer=new n(this.parameters.slot),this.mediaPlayer.getPromised=function(){this.timeOutHandler&&clearTimeout(this.timeOutHandler),i({status:"this ok"})}.bind(this),this.mediaPlayer.id=this.id,this.mediaPlayer.title=this.title,this.hasOwnProperty("orig")&&(t=this.orig),this.mediaPlayer.init({mediapath:"",xmlLoader:null,url:t,frame:this.FrameSrc,id_src:this.id},e,this)}.bind(this))},e.exports=s},{"./Statistic":7,"./util//VPAIDEvent":14,"./util//VideoEvent":15,"./util//loadEvents":18,"./util/UTILS":13,"./util/XML":16,"./util/players/BridgePlayer":19,lie:2}],5:[function(t,e,i){"use strict";function s(t){this.slot=t,this.blockId=0,this.parameters={slot:t,version:"2.0"},this.id=0,this.VastFlag=0,this.timeOutHandler=null,this.title="Никак",this.mediaPlayer=null,this.subscribers={},this.flags={},this.flags.paused=!1,this.flags.started=!1,this.flags.stopped=!1,this.medyaFile={type:"",file:""},this.eventCounter=0,this.secondRound=0}var r=t("./util/XML"),o=(t("./util//VideoEvent"),t("./util//VPAIDEvent")),n=t("./util//loadEvents"),a=t("./Statistic"),l=t("./util/players/VPAIDPlayer"),d=t("./util/players/VideoPlayer"),c=(t("./util/UTILS").getNextBlockUrl,t("./util/UTILS").getHostName,t("lie"));s.prototype.subscribe=function(t,e,i){"string"==typeof e&&(e=[e]);for(var s=0,r=e.length;s<r;s++){var o=e[s];this.subscribers[o]||(this.subscribers[o]=[]),this.subscribers[o].push({fn:t,ctx:i||null})}},s.prototype.unsubscribe=function(t,e){"string"==typeof e&&(e=[e]);for(var i=e.length;i>=0;i--){var s=this.subscribers[e[i]];if(s&&Array.isArray(s)&&s.length)for(var r=0,o=s.length;r<o;r++)s[r].fn===t&&s.splice(r,1)}},s.prototype.stop=function(){this.mediaPlayer&&this.mediaPlayer.stop()},s.prototype.play=function(){return new c(function(t,e){this.mediaPlayer?(this.mediaPlayer.play(),this.slot.style.backgroundColor="#000000",this.slot.style.background="#000000 url('https://video.market-place.su/v1/img/loader.gif') no-repeat center center",this.slot.style.backgroundSize="50px 50px",t()):e(["error mediaPlayer",{}])}.bind(this))},s.prototype.FetchData=function(t){function e(t,e){this.mediaPlayer=!1,this.xmlLoader=new r,this.xmlLoader.id_player=this.id,this.xmlLoader.title_player=this.title,this.xmlLoader.loadVast(t,function(t,s){if(t)return e(t,null);var r;if(this.medyaFile.type=s.type,"VideoPlayer"==s.type?r=d:"VPAIDPlayer"==s.type&&(r=l),"function"!=typeof r)return e({status:"player "+s.type+" not ready"});this.mediaPlayer=new r(this.parameters.slot),this.mediaPlayer.getPromised=function(){return e(null,s)}.bind(this),this.mediaPlayer.id=this.id,this.mediaPlayer.title=this.title,this.mediaPlayer.init({mediapath:"",pscC:this.pscC,xmlLoader:this.xmlLoader},i,this)}.bind(this),this)}function i(t){this.SubscribeOut,t.data=t.data||{};var e={},i=o.convertFromVAST(t.type);if(t.data.loadedEvent=n(this.xmlLoader,t.type,e),i){switch(i){case"AdLoaded":case"AdStarted":case"AdVideoStart":case"AdImpression":case"AdVideoFirstQuartile":case"AdVideoMidpoint":case"AdVideoThirdQuartile":case"AdVideoComplete":case"AdClickThru":case"AdViewable":case"click":if("function"==typeof this.SubscribeVAST&&this.SubscribeVAST({event:i}),"function"==typeof this.SubscribeOut){if(this.SubscribeOut({event:i}),this.VastFlag){r={page_key:this.GlobalMyGUITemp,event:i,id_src:this.id,block:this.blockId,control:this.sControl,pid:this.Pid,is_mobile:this.is_Mobile,second:this.second};a(r)}}else{var r={page_key:this.GlobalMyGUITemp,event:i,id_src:this.id,block:this.blockId,control:this.sControl,pid:this.Pid,is_mobile:this.is_Mobile,second:this.second};a(r)}}s.call(this,new o(o.convertFromVAST(t.type),t.data))}}function s(t){(this.subscribers[t.type]||[]).forEach(function(e){e.fn.call(e.ctx,t)})}return new c(function(i,s){e.call(this,t,function(t,e){t&&s({status:"src url failed"}),this.timeOutHandler&&clearTimeout(this.timeOutHandler),i(e)}.bind(this)),this.timeOutHandler=setTimeout(function(){this.stop(),s({status:"timeout 8 sek"})}.bind(this),12e3)}.bind(this))},e.exports=s},{"./Statistic":7,"./util//VPAIDEvent":14,"./util//VideoEvent":15,"./util//loadEvents":18,"./util/UTILS":13,"./util/XML":16,"./util/players/VPAIDPlayer":22,"./util/players/VideoPlayer":23,lie:2}],6:[function(t,e,i){"use strict";function s(t,e){this.slot=t,this.dframe="",this.blockId=0,this.StartClick=0,this.parameters={slot:t,version:"2.0"},this.id=0,this.timeOutHandler=null,this.title="Ќикак",this.mediaPlayer=null,this.subscribers={},this.flags={},this.flags.paused=!1,this.flags.started=!1,this.flags.stopped=!1,this.medyaFile={type:"",file:""},this.eventCounter=0,this.secondRound=0,this.FrameSrc=e}t("./util/XML"),t("./util//VideoEvent");var r=t("./util//VPAIDEvent"),o=(t("./util//loadEvents"),t("./Statistic")),n=t("./util/players/PSEUDOPlayer"),a=(t("./util/UTILS").getNextBlockUrl,t("lie"));s.prototype.subscribe=function(t,e,i){"string"==typeof e&&(e=[e]);for(var s=0,r=e.length;s<r;s++){var o=e[s];this.subscribers[o]||(this.subscribers[o]=[]),this.subscribers[o].push({fn:t,ctx:i||null})}},s.prototype.unsubscribe=function(t,e){"string"==typeof e&&(e=[e]);for(var i=e.length;i>=0;i--){var s=this.subscribers[e[i]];if(s&&Array.isArray(s)&&s.length)for(var r=0,o=s.length;r<o;r++)s[r].fn===t&&s.splice(r,1)}},s.prototype.stop=function(){this.mediaPlayer&&(this.mediaPlayer.stop(),delete this.mediaPlayer)},s.prototype.play=function(){return new a(function(t,e){this.mediaPlayer?(this.mediaPlayer.play(),this.slot.style.backgroundColor="#000000",t()):e(["error mediaPlayer",{}])}.bind(this))},s.prototype.FetchData=function(t){function e(t){t.data=t.data||{};var e=t.type;if(e){switch(e){case"AdLoaded":case"AdStarted":case"AdVideoStart":case"AdImpression":case"AdVideoFirstQuartile":case"AdVideoMidpoint":case"AdVideoThirdQuartile":case"AdVideoComplete":case"AdClickThru":case"AdViewable":var s={page_key:this.GlobalMyGUITemp,event:e,id_src:this.id,block:this.blockId,control:this.sControl,pid:this.Pid,is_mobile:this.is_Mobile,second:this.second};o(s)}var n=new r(r.convertFromVAST(t.type));n.type||(n={type:e,data:null}),i.call(this,n)}}function i(t){(this.subscribers[t.type]||[]).forEach(function(e){console.log([e.ctx,t.type,e.fn]),e.fn.call(e.ctx,t)})}return new a(function(i,s){if(this.timeOutHandler=setTimeout(function(){this.stop(),s({status:"timeout 8 sek"})}.bind(this),8e3),this.hasOwnProperty("playerType"))return this.playerType,s({status:"not found player "+this.playerType+" in Pseudo"});this.medyaFile.type="Pseudo",this.mediaPlayer=new n(this.parameters.slot),this.mediaPlayer.getPromised=function(){this.timeOutHandler&&clearTimeout(this.timeOutHandler),i({status:"this ok"})}.bind(this),this.mediaPlayer.id=this.id,this.mediaPlayer.title=this.title,this.mediaPlayer.init({mediapath:"",xmlLoader:null,url:t,frame:this.dFrame,id_src:this.id,StartClick:this.StartClick},e,this)}.bind(this))},e.exports=s},{"./Statistic":7,"./util//VPAIDEvent":14,"./util//VideoEvent":15,"./util//loadEvents":18,"./util/UTILS":13,"./util/XML":16,"./util/players/PSEUDOPlayer":21,lie:2}],7:[function(t,e,i){"use strict";e.exports=function(t){(new Image).src="https://video.market-place.su/statistic/?p="+Math.random()+"&data="+encodeURIComponent(JSON.stringify(t))}},{}],8:[function(t,e,i){"use strict";function s(){this.subscribers={},this.parameters={version:"2.0"},this.flags={}}function r(t){(this.subscribers[t.type]||[]).forEach(function(e){console.log(["7777711111 --\x3e",t.type]),e.fn.call(e.ctx,t)})}t("./util/VideoEvent");var o=t("./util/VPAIDEvent"),n=t("./util/UTILS").isMobile,a=(t("./util/UTILS").prepareVideoSlot,t("./util/Statistic"),t("./util/Configurator")),l=t("./BlockDispatcher");s.prototype.startAd=function(){this.flags.started||this.flags.stopped||!this.mediaPlayer||(r.call(this,{type:"AdStarted",data:{}}),r.call(this,{type:"AdImpression",data:{}}),this.mediaPlayer.calcControl(100),this.mediaPlayer.StartBlocks(0))},s.prototype.subscribe=function(t,e,i){"string"==typeof e&&(e=[e]);for(var s=0,r=e.length;s<r;s++){var o=e[s];this.subscribers[o]||(this.subscribers[o]=[]),this.subscribers[o].push({fn:t,ctx:i||null})}},s.prototype.unsubscribe=function(t,e){"string"==typeof e&&(e=[e]);for(var i=e.length;i>=0;i--){var s=this.subscribers[e[i]];if(s&&Array.isArray(s)&&s.length)for(var r=0,o=s.length;r<o;r++)s[r].fn===t&&s.splice(r,1)}},s.prototype.stopAd=function(){this.flags.started&&!this.flags.stopped&&(this.flags.stopped=!0)},s.prototype.skipAd=function(){this.flags.started&&!this.flags.stopped&&(this.flags.stopped=!0)},s.prototype.pauseAd=function(){!this.flags.started||this.flags.paused||this.flags.stopped||(this.flags.paused=!0)},s.prototype.resumeAd=function(){this.flags.started&&this.flags.paused&&!this.flags.stopped&&(this.flags.paused=!1)},s.prototype.resizeAd=function(t,e){this.flags.inited&&!this.flags.stopped&&this.mediaPlayer&&(this.parameters.slot.style.width=t+"px",this.parameters.slot.style.height=e+"px")},s.prototype.expandAd=function(){console.log("AdLog",'The method "expandAd" is not implemented')},s.prototype.collapseAd=function(){console.log("AdLog",'The method "collapseAd" is not implemented')},s.prototype.setAdVolume=function(t){this.flags.started&&this.flags.stopped},s.prototype.getAdVolume=function(){return 1},s.prototype.getAdDuration=function(){return 100},s.prototype.getAdLinear=function(){return!0},s.prototype.getAdWidth=function(){return this.parameters.size.width},s.prototype.getAdHeight=function(){return this.parameters.size.height},s.prototype.getAdRemainingTime=function(){return 15},s.prototype.getAdExpanded=function(){return!1},s.prototype.getAdSkippableState=function(){return this.parameters.skippableState},s.prototype.getAdIcons=function(){return this.parameters.icons},s.prototype.getAdCompanions=function(){return this.parameters.companions},s.prototype.initAd=function(t,e,i,s,d,c){if(console.log(["typeof reject ",typeof reject,typeof resolve]),!this.flags.inited){this.flags.inited=!0;var h=JSON.parse(d.AdParameters||"{}");if(this.parameters.size={width:t,height:e},this.parameters.viewMode=i,this.parameters.bitrate=s,this.parameters.skippableState=1,this.parameters.icons=[],this.parameters.companions=[],this.parameters.adParameters=h,this.parameters.creativeData=d,this.parameters.is_mobile=n(),this.parameters.source={},!h.hasOwnProperty("pid"))return r.call(this,new o(o.AdError,'Missing mandatory parameter "pid" in environmentVars'));if(!c.slot||"object"!=typeof c.slot||1!==c.slot.nodeType||!c.slot.nodeName)return r.call(this,new o(o.AdError,'Missing mandatory parameter "slot" in environmentVars'));this.parameters.videoSlot=c.videoSlot,this.parameters.videoSlot,this.parameters.videoSlot.style.display="none",this.parameters.slot=c.slot.appendChild(document.createElement("div")),this.parameters.slot.id="in-ad-parent",this.parameters.slot.style.width=t+"px",this.parameters.slot.style.height=e+"px";var p="https://widget.market-place.su/videoblock/"+h.pid+".json?p="+Math.random();a.ajax(p,{errorFn:function(t){return r.call(this,{type:"AdError",data:t})}.bind(this),successFn:function(t){if(!t)return r.call(this,{type:"AdError",data:{}});var e=JSON.parse(t);return console.log(["resultat 2",p,e]),e.hasOwnProperty("error")?r.call(this,{type:"AdError",data:e.error}):(this.mediaPlayer=new l(this.parameters.slot),console.log(["event data subscribe",this.subscribers]),this.mediaPlayer.SubscribeVAST=function(t){switch(console.log(["data staight ",t.event,this.subscribers[t.event]]),t.event){case"AdLoaded":case"AdStart":case"AdStopped":break;case"END_BLOCK":return this.parameters.videoSlot.style.display="block",r.call(this,{type:"AdStopped",data:{}});default:return r.call(this,{type:t.event,data:{}})}}.bind(this),this.mediaPlayer.Pid=h.pid,this.mediaPlayer.blockId=e.block,this.mediaPlayer.drowSlot(e.settings),this.mediaPlayer.fillBlock(e.ads),this.mediaPlayer.fillBlock(e.ads_cheap),r.call(this,{type:"AdLoaded",data:{}}))}.bind(this)})}},s.prototype.handshakeVersion=function(){return this.parameters.version},e.exports=s},{"./BlockDispatcher":3,"./util/Configurator":10,"./util/Statistic":11,"./util/UTILS":13,"./util/VPAIDEvent":14,"./util/VideoEvent":15}],9:[function(t,e,i){"use strict";function s(t,e){this.slot=t,this.blockId=0,this.lasti=0,this.parameters={slot:t,version:"2.0"},this.id=0,this.timeOutHandler=null,this.title="Никак",this.mediaPlayer=null,this.subscribers={},this.flags={},this.flags.paused=!1,this.flags.started=!1,this.flags.stopped=!1,this.medyaFile={type:"",file:""},this.eventCounter=0,this.secondRound=0,this.FrameSrc=e}t("./util/XML"),t("./util//VideoEvent");var r=t("./util//VPAIDEvent"),o=(t("./util//loadEvents"),t("./Statistic")),n=t("./util/players/VideorollPlayer"),a=t("./util/players/HTMLPlayer"),l=(t("./util/UTILS").getNextBlockUrl,t("lie"));s.prototype.subscribe=function(t,e,i){"string"==typeof e&&(e=[e]);for(var s=0,r=e.length;s<r;s++){var o=e[s];this.subscribers[o]||(this.subscribers[o]=[]),this.subscribers[o].push({fn:t,ctx:i||null})}},s.prototype.unsubscribe=function(t,e){"string"==typeof e&&(e=[e]);for(var i=e.length;i>=0;i--){var s=this.subscribers[e[i]];if(s&&Array.isArray(s)&&s.length)for(var r=0,o=s.length;r<o;r++)s[r].fn===t&&s.splice(r,1)}},s.prototype.stop=function(){this.mediaPlayer&&this.mediaPlayer.stop()},s.prototype.play=function(){return new l(function(t,e){this.mediaPlayer?(this.mediaPlayer.play(),this.slot.style.backgroundColor="#000000",t()):e(["error mediaPlayer",{}])}.bind(this))},s.prototype.FetchData=function(t){function e(t){t.data=t.data||{},console.log([888822," ¤вное событие",t.type,e,this.title]);var e=t.type,s={page_key:this.GlobalMyGUITemp,event:t.type+" ))",id_src:this.id,block:this.blockId,pid:this.Pid,e1:e};if(e){switch(e){case"AdLoaded":case"AdStarted":case"AdVideoStart":case"AdImpression":case"AdVideoFirstQuartile":case"AdVideoMidpoint":case"AdVideoThirdQuartile":case"AdVideoComplete":case"AdClickThru":case"AdViewable":s={page_key:this.GlobalMyGUITemp,event:e,id_src:this.id,block:this.blockId,control:this.sControl,pid:this.Pid,second:this.second};o(s)}var n=new r(r.convertFromVAST(t.type));n.type||(n={type:e,data:t.data}),i.call(this,n)}}function i(t){(this.subscribers[t.type]||[]).forEach(function(e){e.fn.call(e.ctx,t)})}return new l(function(i,s){if(this.timeOutHandler=setTimeout(function(){this.stop(),s({status:"timeout 8 sek"})}.bind(this),8e3),this.hasOwnProperty("playerType"))switch(this.playerType){case"HTML":this.medyaFile.type=this.playerType,this.mediaPlayer=new a(this.parameters.slot);break;default:return s({status:"not found player "+this.playerType+" in Pseudo"})}else this.medyaFile.type="Videoroll",this.mediaPlayer=new n(this.parameters.slot);this.mediaPlayer.getPromised=function(){this.timeOutHandler&&clearTimeout(this.timeOutHandler),i({status:"this ok"})}.bind(this),this.mediaPlayer.id=this.id,this.mediaPlayer.title=this.title,this.mediaPlayer.init({mediapath:"",xmlLoader:null,url:t,lasti:this.lasti,frame:this.FrameSrc,id_src:this.id},e,this)}.bind(this))},e.exports=s},{"./Statistic":7,"./util//VPAIDEvent":14,"./util//VideoEvent":15,"./util//loadEvents":18,"./util/UTILS":13,"./util/XML":16,"./util/players/HTMLPlayer":20,"./util/players/VideorollPlayer":24,lie:2}],10:[function(t,e,i){"use strict";var s={ajax:function(t,e){var i=t,s=(e=e||{}).errorFn||function(){},r=e.successFn||function(){},o=e.type||"GET",n=e.data||{},a=JSON.stringify(n);if(o=o.toUpperCase(),window.XMLHttpRequest)l=new XMLHttpRequest;else var l=new ActiveXObject("Microsoft.XMLHTTP");if("GET"==o){a=null,i.indexOf("?")<0&&(i+="?1=1");for(var d in n)n.hasOwnProperty(d)&&(i+="&"+d+"="+n[d])}l.open(o,i,!0),l.onreadystatechange=function(){4==l.readyState?200==l.status?r({response:l.responseText}):s({status:l.status}):s({status:l.readyState})},l.onreadystatechange=function(){4==l.readyState&&(200==l.status?r(l.responseText):s({status:l.status}))};try{l.withCredentials=e.withCredentials||!1,l.send(a)}catch(t){}}};e.exports=s},{}],11:[function(t,e,i){"use strict";e.exports=function(t){if(t.level,this.hasOwnProperty("GlobalMyGUITemp"))if(t.id&&t.event)switch(console.log([t.event.type,t.title,t.event]),t.id){case 54:case 44:case 43:default:var e={page_key:this.GlobalMyGUITemp,id_src:t.id,counter:t.counter,event:t.event.type,data:t.event.data,media:this.medyaFile};(new Image).src="https://video.market-place.su/mir/?p="+Math.random()+"&data="+encodeURIComponent(JSON.stringify(e))}else console.log(["microstat",t.event.data])}},{}],12:[function(t,e,i){"use strict";e.exports=function(){}},{}],13:[function(t,e,i){"use strict";function s(){var t=navigator.userAgent||navigator.vendor||window.opera;return/windows phone/i.test(t)?5:/android/i.test(t)?3:/iPad|iPod/.test(t)&&!window.MSStream?2:/iPhone/.test(t)&&!window.MSStream?1:6}i.getHostName=function(t){var e=t.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/i);if(null!=e&&e.length>2&&"string"==typeof e[2]&&e[2].length>0)return e[2]},i.parseConfig=function(t){var e={};t.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,i,s){e[i]=s});return e},i.prepareVideoSlot=function(){if(this.parameters.videoSlot){for(this.parameters.cloneSlot={},this.parameters.cloneSlot.videoSlot=this.parameters.videoSlot.cloneNode(!1),this.parameters.cloneSlot.parentSlot=this.parameters.videoSlot.parentNode,this.parameters.cloneSlot.nextToSlot=this.parameters.videoSlot.nextSibling;this.parameters.videoSlot.firstChild;)this.parameters.cloneSlot.videoSlot.appendChild(this.parameters.videoSlot.firstChild);for(;this.parameters.videoSlot.attributes.length;)this.parameters.videoSlot.removeAttribute(this.parameters.videoSlot.attributes[0].name);for(var t in this.parameters.videoSlot.style)this.parameters.videoSlot.style.hasOwnProperty(t)&&(this.parameters.videoSlot.style[t]="")}},i.restoreVideoSlot=function(){if(this.parameters.cloneSlot){for(;this.parameters.videoSlot.firstChild;)this.parameters.videoSlot.removeChild(this.parameters.videoSlot.firstChild);for(;this.parameters.cloneSlot.videoSlot.firstChild;)this.parameters.videoSlot.appendChild(this.parameters.cloneSlot.videoSlot.firstChild);for(;this.parameters.videoSlot.attributes.length;)this.parameters.videoSlot.removeAttribute(this.parameters.videoSlot.attributes[0].name);for(;this.parameters.cloneSlot.videoSlot.attributes.length;)this.parameters.videoSlot.setAttribute(this.parameters.cloneSlot.videoSlot.attributes[0].name,this.parameters.cloneSlot.videoSlot.attributes[0].value),this.parameters.cloneSlot.videoSlot.removeAttribute(this.parameters.cloneSlot.videoSlot.attributes[0].name);for(var t in this.parameters.videoSlot.style)this.parameters.videoSlot.style.hasOwnProperty(t)&&!this.parameters.cloneSlot.videoSlot.style.hasOwnProperty(t)&&delete this.parameters.videoSlot.style[t];for(t in this.parameters.cloneSlot.videoSlot.style)this.parameters.cloneSlot.videoSlot.style.hasOwnProperty(t)&&(this.parameters.videoSlot.style[t]=this.parameters.cloneSlot.videoSlot.style[t]);this.parameters.cloneSlot.parentSlot.insertBefore(this.parameters.videoSlot,this.parameters.cloneSlot.nextToSlot),this.parameters.videoSlot.load()}},i.getNextBlockUrl=function(){var t=this.parameters.adParameters,e=/([?&]{1}vr=)([0-9]+)/g.exec(t.url);return!!(e&&t.block_sequence[e[2]]&&+this.mediaPlayer.extensions.allowBlock)&&t.url.replace(e[0],e[1]+t.block_sequence[e[2]])},i.isMobile=function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))},i.str2time=function(t){if(!t)return 0;var e=0;return(t.match(/(\d\d)/gi)||[]).forEach(function(t,i,s){e+=Math.pow(60,s.length-i-1)*parseInt(t,10)}),e},i.time2str=function(t,e){var i=new Date(1e3*t),s=i.getHours()<10?"0"+i.getHours():i.getHours(),r=i.getMinutes()<10?"0"+i.getMinutes():i.getMinutes(),o=i.getSeconds()<10?"0"+i.getSeconds():i.getSeconds();return(e?s+":":"")+r+":"+o},i.repareUrl=function(t,e){return t.replace(/\{([a-zA-Z0-9]+)\}/g,function(t){var i=t.replace(/[\{\}]+/g,"");switch(i){case"vidlent":var r=["https://vidlent.ru/234-zhizn.html","https://vidlent.ru/231-bratc.html","https://vidlent.ru/232-serdce-voina.html","https://vidlent.ru/252-ubiyca-vnutri-menya.html"];return r[Math.round(Math.random()*r.length)%r.length];case"rnd":return Math.random();case"insta":return s();case"ref":return encodeURIComponent(e.referer);case"refurl":return encodeURIComponent(window.location.hostname);case"tems":var o=[["&puid5=4&puid6=2","Кино / Боевик;"],["&puid5=4&puid6=3","Кино / Военный;"],["&puid5=4&puid6=4","Кино / Детектив;"],["&puid5=4&puid6=5","Кино / Документальный;"],["&puid5=4&puid6=6","Кино / Драма;"],["&puid5=4&puid6=7","Кино / Исторический;"],["&puid5=4&puid6=8","Кино / Комедия;"],["&puid5=4&puid6=9","Кино / Криминал;"],["&puid5=4&puid6=10","Кино / Мелодрама;"],["&puid5=4&puid6=11","Кино / Мистика;"],["&puid5=4&puid6=12","Кино / Молодежный;"],["&puid5=4&puid6=13","Кино / Мюзикл;"],["&puid5=4&puid6=14","Кино / Приключения;"],["&puid5=4&puid6=15","Кино / Семейный;"],["&puid5=4&puid6=16","Кино / Триллер;"],["&puid5=4&puid6=17","Кино / Ужас;"],["&puid5=4&puid6=18","Кино / Фантастика;"],["&puid5=4&puid6=19","Кино / Юмор;"],["&puid5=4&puid6=20","Кино / Прочее"],["&puid5=16&puid6=21","Сериалы / Детектив;"],["&puid5=16&puid6=23","Сериалы / Драма;"],["&puid5=16&puid6=24","Сериалы / Комедия;"],["&puid5=16&puid6=25","Сериалы / Криминал;"],["&puid5=16&puid6=26","Сериалы / Триллер;"],["&puid5=16&puid6=27","Сериалы / Фантастика;"],["&puid5=16&puid6=28","Сериалы / Юмор;"],["&puid5=16&puid6=29","Сериалы / Прочее"],["&puid5=2&puid6=31","Дети и родители / Мультсериалы"],["&puid5=2&puid6=32","Дети и родители / мультфильм короткометражный;"],["&puid5=2&puid6=33","Дети и родители / мультфильм полнометражный"]],n=new function(){this.next=function(t,e){if(t=void 0==t?0:t,e=void 0==e?1:e,this.ready)return this.ready=!1,this.second*e+t;var i,s,r;do{r=(i=2*Math.random()-1)*i+(s=2*Math.random()-1)*s}while(r>1||0==r);var o=Math.sqrt(-2*Math.log(r)/r);return this.second=o*i,this.ready=!0,o*s*e+t}};return o[d=Math.floor(Math.abs(n.next(10,6)))%o.length][0];case"instr1":var a=["2","3","4","6","8","10","14","15","2","3","4","6","8","10","14","15","16","17","18","18"];return a[d=Math.floor(Math.random()*a.length)];case"instr2":var l=["3","4","3","4","5"],d=Math.floor(Math.random()*l.length);return l[d]}if(-1!=i.indexOf("randInt")){var c=i.replace("randInt","");return Math.floor(Math.random()*(c-1))+1}return t}.bind(this))}},{}],14:[function(t,e,i){"use strict";function s(t,e){this.type=t,this.data=e}var r=t("./VideoEvent");s.convertToVAST=function(t){return{AdLoaded:r.AD_READY,AdVolumeChange:r.AD_VOLUME_CHANGE,AdError:r.AD_ERROR,AdStarted:r.AD_START,AdImpression:r.AD_IMPRESSION,AdStopped:r.AD_STOP,AdPaused:r.AD_PAUSE,AdPlaying:r.AD_RESUME,AdVideoStart:r.VIDEO_START,AdVideoFirstQuartile:r.VIDEO_FIRST_QUARTILE,AdVideoMidpoint:r.VIDEO_MIDPOINT,AdVideoThirdQuartile:r.VIDEO_THIRD_QUARTILE,AdVideoComplete:r.VIDEO_COMPLETE,AdUserClose:r.USER_CLOSE,AdSkipped:r.USER_SKIP,AdUserAcceptInvitation:r.USER_ACCEPT_INVENTATION,AdInteraction:r.USER_INTERACTION,AdClickThru:r.USER_CLICK,AdViewable:r.AD_VIEWABLE,AdNotViewable:r.AD_NOT_VIEWABLE,AdViewUndetermined:r.AD_VIEW_UNDETERMINED}[t]||""},s.convertFromVAST=function(t){return{ready:s.AdLoaded,volumeChange:s.AdVolumeChange,error:s.AdError,creativeView:s.AdStarted,impression:s.AdImpression,stop:s.AdStopped,pause:s.AdPaused,resume:s.AdPlaying,start:s.AdVideoStart,firstQuartile:s.AdVideoFirstQuartile,midpoint:s.AdVideoMidpoint,thirdQuartile:s.AdVideoThirdQuartile,complete:s.AdVideoComplete,closeLinear:s.AdUserClose,skip:s.AdSkipped,acceptInvitation:s.AdUserAcceptInvitation,interaction:s.AdInteraction,click:s.AdClickThru,viewable:s.AdViewable,notViewable:s.AdNotViewable,viewUndetermined:s.AdViewUndetermined}[t]||""},s.AdLoaded="AdLoaded",s.AdStarted="AdStarted",s.AdStopped="AdStopped",s.AdSkipped="AdSkipped",s.AdLinearChange="AdLinearChange",s.AdSizeChange="AdSizeChange",s.AdExpandedChange="AdExpandedChange",s.AdSkippableStateChange="AdSkippableStateChange",s.AdRemainingTimeChange="AdRemainingTimeChange",s.AdDurationChange="AdDurationChange",s.AdVolumeChange="AdVolumeChange",s.AdImpression="AdImpression",s.AdVideoStart="AdVideoStart",s.AdVideoFirstQuartile="AdVideoFirstQuartile",s.AdVideoMidpoint="AdVideoMidpoint",s.AdVideoThirdQuartile="AdVideoThirdQuartile",s.AdVideoComplete="AdVideoComplete",s.AdClickThru="AdClickThru",s.AdInteraction="AdInteraction",s.AdUserAcceptInvitation="AdUserAcceptInvitation",s.AdUserMinimize="AdUserMinimize",s.AdUserClose="AdUserClose",s.AdPaused="AdPaused",s.AdPlaying="AdPlaying",s.AdLog="AdLog",s.AdError="AdError",s.AdViewable="AdViewable",s.AdNotViewable="AdNotViewable",s.AdViewUndetermined="AdViewUndetermined",e.exports=s},{"./VideoEvent":15}],15:[function(t,e,i){"use strict";function s(t,e){this.type=t,this.data=e}s.AD_READY="ready",s.AD_VOLUME_CHANGE="volumeChange",s.AD_ERROR="error",s.AD_STOP="stop",s.AD_START="creativeView",s.AD_IMPRESSION="impression",s.AD_MUTE="mute",s.AD_UNMUTE="unmute",s.AD_PAUSE="pause",s.AD_RESUME="resume",s.AD_REWIND="rewind",s.AD_VIEWABLE="viewable",s.AD_NOT_VIEWABLE="notViewable",s.AD_VIEW_UNDETERMINED="viewUndetermined",s.VIDEO_START="start",s.VIDEO_FIRST_QUARTILE="firstQuartile",s.VIDEO_MIDPOINT="midpoint",s.VIDEO_THIRD_QUARTILE="thirdQuartile",s.VIDEO_COMPLETE="complete",s.VIDEO_PROGRESS="progress",s.USER_CLOSE="closeLinear",s.USER_SKIP="skip",s.USER_ACCEPT_INVENTATION="acceptInvitation",s.USER_INTERACTION="interaction",s.USER_CLICK="click",e.exports=s},{}],16:[function(t,e,i){"use strict";function s(){if(!(!o.XMLHttpRequest||o.location&&"file:"==o.location.protocol&&o.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}return!1}function r(t){this.id_player=0,this.title_player="",this.id="myXML_Class",this.flightMap=t}var o;t("./Statistic"),t("./URLUtils");o="undefined"!=typeof window?window:"undefined"!=typeof self?self:this,r.prototype.loadVast=function(t,e,i){if(this.url=t,this.xml=null,this.flight=null,this.xmlType="unknown",this.wrapper=null,this.urlData=null,this.context=i,this.currentXML=null,!t)return e({status:"URL is not valid",code:101,errno:100});t=r.makeCheck.call(this,r.correctProtocol(t)),this.urlData=r.getUrlData(t);var o=s();location.protocol,o.withCredentials=!0,o.timeout=11e3,o.open("GET",t,!0),o.onreadystatechange=function(s){if(4==o.readyState&&200==o.status){if(!o.responseXML)return e({status:"my XML Response is not XML  |"+encodeURIComponent(t)+"| ",code:100,errno:101});var n=new DOMParser;this.xml=n.parseFromString(o.responseText,"application/xml");for(var a in r.SUPPORTED_XML_STANDARD)if(r.SUPPORTED_XML_STANDARD.hasOwnProperty(a)&&this.xml.querySelector(r.SUPPORTED_XML_STANDARD[a].selector)){this.xmlType=r.SUPPORTED_XML_STANDARD[a].type;break}if(!this.xmlType||"unknown"===this.xmlType)return this.currentXML=this.xml,e({status:"Unknown XML format | "+JSON.stringify([this.xml,s.target.responseXML]),code:102});var l,d,c,h,p;if(!this.xml.querySelector(r.SELECTORS.wrapperTag)){var u=this.xml.querySelectorAll("Ad");if(!this.flightMap){for(h=0;h<u.length;h++)if(r.hasSupportedContent(u[h]))return this.currentXML=u[h],e(null,{xml:this.currentXML,type:r.getMediaType(this.currentXML)});this.currentXML=this.xml;this.currentXML.querySelector("MediaFile");return e({status:"Supported media files not found ft |"+u.length+"|"+JSON.stringify(u),code:403})}if(!this.flightMap.length){for(h=0;h<u.length;h++)if(r.hasSupportedContent(u[h]))return this.currentXML=u[h],e(null,{xml:this.currentXML,type:r.getMediaType(this.currentXML)});return this.currentXML=this.xml,e({status:"Supported media files not found",code:403})}for(c=this.flightMap.length,h=0;h<c;h++)if(p=this.flightMap[h],d=this.xml.querySelector(r.getFilterSelectorByFlight(p,!0))){for(l=p;"Ad"!=d.nodeName;)d=d.parentNode;if(!r.hasSupportedContent(d)){d=null;continue}return this.flight=l,this.currentXML=d,e(null,{xml:this.currentXML,type:r.getMediaType(this.currentXML)})}for(h=0;h<c;h++)if(p=this.flightMap[h],d=this.xml.querySelector(r.getFilterSelectorByFlight(p,!1))){for(l=p;"Ad"!=d.nodeName;)d=d.parentNode;if(!r.hasSupportedContent(d)){d=null;continue}return this.flight=l,this.currentXML=d,e(null,{xml:this.currentXML,type:r.getMediaType(this.currentXML)})}return this.currentXML=this.xml,e({status:"Available ads not found",code:200})}if(this.flightMap&&this.flightMap.length)return e({status:"wait a mig",code:403});this.currentXML=this.xml.firstChild,this.wrapper=new r(r.getFlightsMap(this.currentXML)),this.wrapper.loadVast(r.trimXMLNode(this.xml.querySelector(r.SELECTORS.wrapperTag)),e,i)}}.bind(this),o.send(null)},r.prototype.getEvents=function(t){if(!r.EventsSelector[t])return[];for(var e=this.currentXML&&!r.getNoTrack(this.currentXML)?this.currentXML.querySelectorAll(r.EventsSelector[t]):[],i=[],s=0;s<e.length;s++)i.push(r.makeCheck.call(this,r.correctProtocol(r.trimXMLNode(e[s]))));return i.concat(this.wrapper?this.wrapper.getEvents(t):[])},r.trimXMLNode=function(t){return t?(void 0!==t.firstChild&&(t=t.firstChild),t&&void 0!==t.wholeText&&(t=t.wholeText),t&&void 0!==t.trim&&(t=t.trim()),t):""},r.getAlternateURI=function(t){return t?r.trimXMLNode(t.querySelector("data AlternateSystemURI, Extension[type='AlternateSystemURI']")):null},r.getMediaType=function(t){return t.querySelector("MediaFile[type='video/mp4'],MediaFile[type='video/ogg'],MediaFile[type='video/webm']")?"VideoPlayer":t.querySelector("MediaFile[apiFramework='VPAID'][type='application/javascript']")?"VPAIDPlayer":"Unknown"},r.hasSupportedContent=function(t){return t.querySelector(r.SELECTORS.wrapperTag)||!!t.querySelector(r.SELECTORS.supportedMediaFormat)},r.SELECTORS={supportedMediaFormat:"MediaFile[type='video/mp4'],MediaFile[type='video/ogg'],MediaFile[type='video/webm'],MediaFile[apiFramework='VPAID'][type='application/javascript']",wrapperTag:"Wrapper VASTAdTagURI, data VASTAdTagURI"},r.EventsSelector={impression:"Ad Impression, data event loaded, data trace loaded",creativeView:"Ad Linear TrackingEvents Tracking[event='creativeView']",start:"Ad Linear TrackingEvents Tracking[event='start'], data event ready, data trace ready",pause:"Ad Linear TrackingEvents Tracking[event='pause']",resume:"Ad Linear TrackingEvents Tracking[event='resume']",firstQuartile:"Ad Linear TrackingEvents Tracking[event='firstQuartile'], data event quarter, data trace quarter",midpoint:"Ad Linear TrackingEvents Tracking[event='midpoint'], data event half, data trace half",thirdQuartile:"Ad Linear TrackingEvents Tracking[event='thirdQuartile'], data event threequarters, data trace threequarters",complete:"Ad Linear TrackingEvents Tracking[event='complete'], data event complete, data trace complete",mute:"Ad Linear TrackingEvents Tracking[event='mute'], data event mute, data trace mute",unmute:"Ad Linear TrackingEvents Tracking[event='unmute'], data event unmute, data trace unmute",acceptInvitation:"Ad Extensions Extension[type='addClick'], VideoClicks ClickTracking, data event acceptInvitation, data trace acceptInvitation",click:"VideoClicks ClickTracking, data clickTAG",closeLinear:"Ad Linear TrackingEvents Tracking[event='close'], data event close, data trace close",skip:"Ad Extensions Extension[type='skipAd'], data event skip, data trace skip",error:"Ad Error, Error",viewable:"Ad Extensions Extension[type='viewable'], data event viewable, data trace viewable",notViewable:"Ad Extensions Extension[type='notViewable'], data event notViewable, data trace notViewable",viewUndetermined:"Ad Extensions Extension[type='viewUndetermined'], data event viewUndetermined, data trace viewUndetermined"},r.SUPPORTED_XML_STANDARD={VAST_2_0:{selector:"VAST[version='2.0'] Ad",type:"VAST"},VAST_3_0:{selector:"VAST[version='3.0'] Ad",type:"VAST"},NON_VAST:{selector:"data flightsmap id[eid]",type:"NON-VAST"}},r.makeCheck=function(t){return t},r.correctProtocol=function(t){return t?"http:"==location.protocol?t.replace("https:","http:"):t.replace("http:","https:"):""},r.getUrlData=function(t){if("string"==typeof t&&t){var e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);return{protocol:e[2],hostname:e[4],pathname:e[5],search:void 0!==e[7]?e[7]:"rnd="+Math.random(),hash:e[9]}}return{}},r.excludeParams=function(t,e){return Array.isArray(e)&&(e||[]).forEach(function(e){t=t.replace(new RegExp("^("+e+"=[^&]*[&]{0,1})|([&]{0,1}"+e+"=[^&]*)","i"),"")}),t},r.getNoTrack=function(t){return t?!!+r.trimXMLNode(t.querySelector("data noTrack, Extension[type='noTrack']")):null},r.getFlightsMap=function(t){for(var e=t.querySelectorAll("flightsmap id[eid]"),i=[],s=0;s<e.length;s++)i.push({bid:r.trimXMLNode(e[s]),id:e[s].getAttribute("eid").split("-")[0],adID:e[s].getAttribute("eid").split("-")[1]});return i},r.getFilterSelectorByFlight=function(t,e){var i=e?"":"Creative[id='"+t.id+"']";return["AdID","adID","AdId","AdID"].map(function(s,r,o){e?(i+="Creative[id='"+t.id+"']["+s+"='"+t.adID+"']",i+=o.length-r>1?",":""):i+=":not(["+s+"])"}),i},r.prototype.getExtensions=function(t){t=t||{};for(var e=this.currentXML.querySelectorAll("Extensions Extension[type]"),i=0;i<e.length;i++)t[e[i].getAttribute("type")]=r.trimXMLNode(e[i]);return this.wrapper?this.wrapper.getExtensions(t):t},r.prototype.getMediaFiles=function(){if(this.wrapper)return this.wrapper.getMediaFiles();for(var t=[],e=this.currentXML.querySelectorAll(r.SELECTORS.supportedMediaFormat),i=0;i<e.length;i++)t.push({type:e[i].getAttribute("type"),src:r.trimXMLNode(e[i])});return t},r.prototype.getAdParameters=function(){return this.wrapper?this.wrapper.getAdParameters():r.trimXMLNode(this.currentXML.querySelector("AdParameters"))},r.prototype.getAdLink=function(){return this.wrapper?this.wrapper.getAdLink():r.trimXMLNode(this.currentXML.querySelector("VideoClicks ClickThrough"))},e.exports=r},{"./Statistic":11,"./URLUtils":12}],17:[function(t,e,i){"use strict";function s(t){var t=t||r();return void 0===window.MpFrameBridges&&(window.MpFrameBridges={}),void 0!==window.MpFrameBridges[t]?window.MpFrameBridges[t]:(window.MpFrameBridges[t]=new o(t),window.MpFrameBridges[t])}function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})}function o(t){this.index=t||r();var e=this,i={default:function(){console.log(i,this,e)}};this.execAction=function(t,e){(i[t]||i.default||function(){}).call(this,e)},this.addAction=function(t,e){i[t]=e},this.showActions=function(){console.log(i)}}window.makeBridge=s,window.mp_bridge_listener=function(t){if("object"==typeof t.data&&void 0!==t.data.bridgeAction&&1==t.data.bridgeAction){if("broadcast"==t.data.data.index&&void 0!==window.MpFrameBridges)for(var e in window.MpFrameBridges)window.MpFrameBridges.hasOwnProperty(e)&&window.MpFrameBridges[e].execAction(t.data.name,t.data.data);s(t.data.data.index).execAction(t.data.name,t.data.data)}},void 0===window.MpBridgeListenerAttached&&(window.addEventListener?window.addEventListener("message",mp_bridge_listener):window.attachEvent("onmessage",mp_bridge_listener),window.MpBridgeListenerAttached=!0),e.exports={Bridge:s,callAction:function(t,e,i){i.postMessage({name:t,data:e,bridgeAction:!0},"*")}}},{}],18:[function(t,e,i){"use strict";t("./Statistic");e.exports=function(t,e,i){for(var s=t.getEvents(e),r=0,o=0;o<s.length;o++)if(s[o]&&"http"===s[o].slice(0,4)){if(i)for(var n in i)s[o]=s[o].replace(new RegExp("((\\[|%5B)"+n+"(\\]|%5D))","gi"),i[n]);(new Image).src=s[o],r++}return r}},{"./Statistic":11}],19:[function(t,e,i){"use strict";function s(t){this.id=0,this.tmp_src=0,this.title="",this.root=t.appendChild(document.createElement("div")),this.root.style.width="100%",this.root.style.height="100%",this.root.style.position="relative",this.root.className="waiting",this.flags={middleEvent:[!1,!1,!1,!1,!1]}}var r=t("./../VideoEvent"),o=t("./../VPAIDEvent"),n=t("./../UTILS").restoreVideoSlot,a=(t("./../UTILS").str2time,t("./../UTILS").time2str,t("./../iFrameBridge")),l=a.Bridge,d=a.callAction;s.prototype.init=function(t,e,i){if(this.root.id="mp_"+this.id+"-video-player",this.root.className="mp-video-player waiting",!this.flags.inited){this.flags.inited=!0,this.parent={dispatcher:e,context:i},this.FrameSrc=t.frame;var r=new l;this.bridgeIndex=r.index;var o={url:t.url,index:r.index,id_src:t.id_src},n=(t.id_src,this.FrameSrc+"?p="+Math.random()+"&data="+encodeURIComponent(JSON.stringify(o)));this.slot=this.root.appendChild(document.createElement("iframe")),this.slot.style.width="100%",this.slot.style.background="100%",this.slot.style.height="100%",this.slot.style.border="0",this.slot.scrolling="no",this.slot.src=n,r.addAction("adEvent",function(t){if(t.hasOwnProperty("index")&&t.index==r.index&&t.hasOwnProperty("event"))switch(t.event){case"AdLoaded":this.getPromised();break;case"BlockStoppped":this.stop();break;default:s.$dispatchEvent.call(this,t.event,{})}}.bind(this))}},s.prototype.play=function(){if(!this.flags.started&&!this.flags.stopped){this.flags.started=!0;try{d("adEvent",{index:"broadcast",event:"Start"},this.slot.contentWindow)}catch(t){return console.log(["смертельная ошибка",t]),this.error({status:"VPAID creative internal JS error during startAd",code:405})}}},s.prototype.stop=function(){this.flags.stopped||(s.cleanSlot.call(this),s.$dispatchEvent.call(this,r.AD_STOP,{}))},s.$dispatchEvent=function(t,e){this.parent.dispatcher.call(this.parent.context,new r(t,e,this))},s.vpaidEventHandler=function(t,e){var i={};this.flags.inited&&o.convertToVAST(t)&&s.$dispatchEvent.call(this,o.convertToVAST(t),i)},s.cleanSlot=function(){if(this.flags.inited){this.flags.inited=!1;try{for(var t in o)t&&o.hasOwnProperty(t)&&"string"==typeof o[t]&&this.mediaPlayer.unsubscribe(s.vpaidEventHandler.bind(this,o[t]),o[t]);this.flags.stopped||(this.parent.context.parameters.cloneSlot||this.mediaPlayer.setAdVolume(0),this.mediaPlayer.stopAd())}catch(t){}this.flags.stopped=!0,this.timeoutInterval&&clearTimeout(this.timeoutInterval),this.timeoutInterval=!1,n.call(this.parent.context),this.root&&this.root.parentNode.removeChild(this.root)}},e.exports=s},{"./../UTILS":13,"./../VPAIDEvent":14,"./../VideoEvent":15,"./../iFrameBridge":17}],20:[function(t,e,i){"use strict";function s(t,e){var i=0,s=[!1,!1,!1,!1],o=setInterval(function(){var t=i/e;t>=.25&&!s[0]?(s[0]=!0,r.$dispatchEvent.call(this,"AdVideoFirstQuartile",{})):t>=.5&&!s[1]?(s[1]=!0,r.$dispatchEvent.call(this,"AdVideoMidpoint",{})):t>=.75&&!s[2]&&(s[2]=!0,r.$dispatchEvent.call(this,"AdVideoThirdQuartile",{})),i>=e?clearInterval(o):i++}.bind(this),1e3);return o}function r(t){this.counter=0,this.films=[],this.id=0,this.lasti=0,this.tmp_src=0,this.title="",this.root=t.appendChild(document.createElement("div")),this.root.style.width="100%",this.root.style.height="100%",this.root.className="waiting",this.flags={middleEvent:[!1,!1,!1,!1,!1]}}var o=t("./../VideoEvent"),n=t("./../VPAIDEvent"),a=t("./../UTILS").restoreVideoSlot,l=(t("./../UTILS").str2time,t("./../UTILS").time2str,t("./../iFrameBridge")),d=l.Bridge;l.callAction;r.prototype.init=function(t,e,i){if(this.root.id="mp_"+this.id+"-video-player",this.root.className="mp-video-player waiting",!this.flags.inited){this.flags.inited=!0,this.parent={dispatcher:e,context:i},this.FrameSrc=t.frame;var o=new d;this.bridgeIndex=o.index;var n={url:t.url,index:o.index,id_src:t.id_src};t.id_src;this.FrameSrc=this.FrameSrc+"?p="+Math.random()+"&data="+encodeURIComponent(JSON.stringify(n)),this.slot=this.root.appendChild(document.createElement("iframe")),this.slot.style.width="100%",this.slot.style.height="100%",this.slot.style.border="0",this.slot.scrolling="no","function"==typeof this.getPromised&&this.getPromised(),o.addAction("adEvent",function(t){if(console.log([1111119,t]),t.hasOwnProperty("index")&&t.index==o.index&&t.hasOwnProperty("event")){switch(t.event){case"BlockStoppped":if(2==this.lasti)return;this.stop();break;case"AdVideoStart":1==this.lasti&&(console.log(["111111--","||",dat.event,this.title]),this.lasti=2);var e=s.call(this,this.counter,37);this.films.push(e),this.counter++;default:r.$dispatchEvent.call(this,t.event,{})}console.log(["дата перевертыш ",t.event])}}.bind(this))}},r.prototype.play=function(){this.flags.started||this.flags.stopped||(this.flags.started=!0,this.slot.src=this.FrameSrc)},r.prototype.stop=function(){if(!this.flags.stopped){for(var t=0,e=this.films.length;t<e;t++)this.films[t]&&clearInterval(this.films);r.cleanSlot.call(this),r.$dispatchEvent.call(this,o.AD_STOP,{})}},r.$dispatchEvent=function(t,e){this.parent.dispatcher.call(this.parent.context,new o(t,e,this))},r.vpaidEventHandler=function(t,e){var i={};this.flags.inited&&n.convertToVAST(t)&&r.$dispatchEvent.call(this,n.convertToVAST(t),i)},r.cleanSlot=function(){if(this.flags.inited){this.flags.inited=!1;try{for(var t in n)t&&n.hasOwnProperty(t)&&"string"==typeof n[t]&&this.mediaPlayer.unsubscribe(PSEUDOPlayer.vpaidEventHandler.bind(this,n[t]),n[t]);this.flags.stopped||(this.parent.context.parameters.cloneSlot||this.mediaPlayer.setAdVolume(0),this.mediaPlayer.stopAd())}catch(t){}this.flags.stopped=!0,this.timeoutInterval&&clearTimeout(this.timeoutInterval),this.timeoutInterval=!1,a.call(this.parent.context),this.root&&this.root.parentNode.removeChild(this.root)}},e.exports=r},{"./../UTILS":13,"./../VPAIDEvent":14,"./../VideoEvent":15,"./../iFrameBridge":17}],21:[function(t,e,i){"use strict";function s(t,e){var i=0,s=[!1,!1,!1,!1],o=setInterval(function(){var t=i/e;if(t>=.25&&!s[0]?(s[0]=!0,r.$dispatchEvent.call(this,"AdVideoFirstQuartile",{})):t>=.5&&!s[1]?(s[1]=!0,r.$dispatchEvent.call(this,"AdVideoMidpoint",{})):t>=.75&&!s[2]&&(s[2]=!0,r.$dispatchEvent.call(this,"AdVideoThirdQuartile",{})),i>=e)return clearInterval(o),void r.$dispatchEvent.call(this,"AdVideoComplete",{});i++}.bind(this),1e3);return o}function r(t){this.counter=0,this.films=[],this.id=0,this.tmp_src=0,this.title="",this.root=t.appendChild(document.createElement("div")),this.root.className="waiting",this.flags={middleEvent:[!1,!1,!1,!1,!1]}}var o=t("./../VideoEvent"),n=t("./../VPAIDEvent"),a=t("./../UTILS").restoreVideoSlot,l=(t("./../UTILS").str2time,t("./../UTILS").time2str,t("./../iFrameBridge"));l.Bridge,l.callAction;r.prototype.init=function(t,e,i){function n(t){if("object"==typeof t.data&&"auto"==t.data.message){var e=s.call(this,this.counter,t.data.duration);this.films.push(e),this.counter++,r.$dispatchEvent.call(this,"AdImpression",{}),r.$dispatchEvent.call(this,"AdStarted",{}),r.$dispatchEvent.call(this,"AdVideoStart",{})}else"object"==typeof t.data&&"noAds"==t.data.message&&setTimeout(function(){this.slot.contentWindow[this.StartClick]&&this.slot.contentWindow[this.StartClick].click()}.bind(this),1e3)}if(this.root.id="mp_"+this.id+"-video-player",this.root.className="mp-video-player waiting",this.frameSrc=t.frame,this.rootSrc=t.url,this.StartClick=t.StartClick,!this.flags.inited){this.flags.inited=!0,this.parent={dispatcher:e,context:i};var a=document.createElement("link");if(a.href="https://video.market-place.su/v1/style.css",a.rel="stylesheet",this.root.appendChild(a),this.slot=this.root.appendChild(document.createElement("iframe")),this.slot.style.width="100%",this.slot.style.background="100%",this.slot.style.height="100%",this.slot.style.border="0",this.slot.scrolling="no",this.script=document.createElement("script"),this.script.src=this.rootSrc,this.script.setAttribute("block-width","100%"),this.script.setAttribute("block-height","100%"),!this.StartClick)return"function"==typeof this.getPromised&&(console.log("ты готов?"),setTimeout(function(){this.counter?console.log("вижу что готов"):(console.log("вижу что не готов"),r.$dispatchEvent.call(this,"AdError",{status:"рекламы нет",code:0}),this.stop())}.bind(this),2e4),this.getPromised()),setTimeout(function(){console.log("ненадо 255 так"),r.$dispatchEvent.call(this,"AdError",{status:"рекламы нет",code:0}),this.stop()}.bind(this),6e4),r.$dispatchEvent.call(this,o.AD_READY,{});this.slot.contentWindow.document.open(),this.slot.contentWindow.MXoverrollCallback=function(){this.stop()}.bind(this),this.slot.contentWindow.MXoverrollCallbackLoad=function(){return this.slot.contentWindow.document.close(),"function"==typeof this.getPromised&&this.getPromised(),r.$dispatchEvent.call(this,o.AD_READY,{})}.bind(this),this.slot.contentWindow.document.close(),this.slot.contentWindow.document.body.style.margin=0,this.slot.contentWindow.document.body.style.padding=0;var l=document.createElement("div");l.id="MT_overroll",l.style.width="100%",l.style.height="100%",l.style.background="#000",l.style.border="none",l.style.testAlign="center",this.sdq=document.createElement("span"),this.sdq.style.display="inline-block",this.sdq.style.color="white",l.appendChild(this.sdq),this.slot.contentWindow.document.body.appendChild(l),this.slot.contentWindow.document.body.appendChild(this.script),this.slot.contentWindow.addEventListener?this.slot.contentWindow.addEventListener("message",n.bind(this)):this.slot.contentWindow.attachEvent("onmessage",n.bind(this))}},r.prototype.play=function(){function t(t){if("object"==typeof t.data&&"auto"==t.data.message){e=1;var i=s.call(this,this.counter,t.data.duration);this.films.push(i),this.counter++,r.$dispatchEvent.call(this,"AdImpression",{}),r.$dispatchEvent.call(this,"AdStarted",{}),r.$dispatchEvent.call(this,"AdImpression",{}),r.$dispatchEvent.call(this,"AdVideoStart",{})}else"object"==typeof t.data&&"noAds"==t.data.message?setTimeout(function(){this.slot.contentWindow.document.body.innerHTML="",this.slot.contentWindow.document.body.appendChild(this.script)}.bind(this),1e3):"object"==typeof t.data&&"close"==t.data.message&&this.stop()}if(!this.flags.started&&!this.flags.stopped){if(this.flags.started=!0,this.slot.contentWindow[this.StartClick])return this.slot.contentWindow[this.StartClick].click(),r.$dispatchEvent.call(this,"AdImpression",{}),void r.$dispatchEvent.call(this,"AdStarted",{});var e=0;this.slot.contentWindow.document.open(),this.slot.contentWindow.document.close(),this.slot.contentWindow.document.body.style.margin=0,this.slot.contentWindow.document.body.style.padding=0,this.slot.contentWindow.document.body.appendChild(this.script),this.slot.contentWindow.addEventListener?this.slot.contentWindow.addEventListener("message",t.bind(this)):this.slot.contentWindow.attachEvent("onmessage",t.bind(this)),setTimeout(function(){e||this.stop()}.bind(this),45e3)}},r.prototype.stop=function(){if(!this.flags.stopped){for(var t=0,e=this.films.length;t<e;t++)this.films[t]&&clearInterval(this.films);r.cleanSlot.call(this),r.$dispatchEvent.call(this,o.AD_STOP,{})}},r.$dispatchEvent=function(t,e){this.parent.dispatcher.call(this.parent.context,new o(t,e,this))},r.vpaidEventHandler=function(t,e){var i={};this.flags.inited&&n.convertToVAST(t)&&r.$dispatchEvent.call(this,n.convertToVAST(t),i)},r.cleanSlot=function(){if(this.flags.inited){this.flags.inited=!1;try{for(var t in n)t&&n.hasOwnProperty(t)&&"string"==typeof n[t]&&this.mediaPlayer.unsubscribe(r.vpaidEventHandler.bind(this,n[t]),n[t]);this.flags.stopped||(this.parent.context.parameters.cloneSlot||this.mediaPlayer.setAdVolume(0),this.mediaPlayer.stopAd())}catch(t){}this.flags.stopped=!0,this.timeoutInterval&&clearTimeout(this.timeoutInterval),this.timeoutInterval=!1,a.call(this.parent.context),this.root&&this.root.parentNode.removeChild(this.root)}},e.exports=r},{"./../UTILS":13,"./../VPAIDEvent":14,"./../VideoEvent":15,"./../iFrameBridge":17}],22:[function(t,e,i){"use strict";function s(t){this.id=0,this.title="",this.root=t.appendChild(document.createElement("div")),this.root.className="waiting",this.flags={middleEvent:[!1,!1,!1,!1,!1]}}var r=t("./../VideoEvent"),o=t("./../VPAIDEvent"),n=t("./../UTILS").restoreVideoSlot,a=t("./../UTILS").str2time,l=t("./../UTILS").time2str;s.prototype.init=function(t,e,i){if(this.root.id="mp_"+this.id+"-video-player",this.root.className="mp-video-player waiting",!this.flags.inited){this.flags.inited=!0,this.parent={dispatcher:e,context:i};for(var r=null,n=t.xmlLoader.getMediaFiles(),l=0;l<n.length;l++)"application/javascript"==n[l].type&&(r=n[l].src);if(!r)return this.error({status:"VPAID creative was not found",code:403});var d=t.xmlLoader.getExtensions(),c={};if(this.extensions={controls:"1"===d.controls,skipTime:a(d.skipTime),closeTime:a(d.skipTime2),isClickable:"0"!==d.isClickable,adLink:d.adLink||"http://poexaly.com",linkText:decodeURIComponent(d.linkText||"%D0%9F%D0%B5%D1%80%D0%B5%D0%B9%D1%82%D0%B8%20%D0%BD%D0%B0%20%D1%81%D0%B0%D0%B9%D1%82%20%D1%80%D0%B5%D0%BA%D0%BB%D0%B0%D0%BC%D0%BE%D0%B4%D0%B0%D1%82%D0%B5%D0%BB%D1%8F"),allowBlock:d.Allowblock},c=document.createElement("link"),c.href="https://video.market-place.su/v1/style.css",c.rel="stylesheet",this.root.appendChild(c),this.slot=this.root.appendChild(document.createElement("iframe")),this.slot.style.width="100%",this.slot.style.background="100%",this.slot.style.height="100%",this.slot.style.border="0",this.slot.scrolling="no",t.pscC){var h=document.createElement("script");h.src=t.pscC,this.slot.contentWindow.document.body.appendChild(h)}this.script=document.createElement("script"),this.script.src=r,this.slot.contentWindow.document.body.appendChild(this.script);var p=0,u=setInterval(function(){if(this.flags.stopped)clearInterval(u);else{if(this.slot.contentWindow&&"function"==typeof this.slot.contentWindow.getVPAIDAd){clearInterval(u),this.slot.contentWindow.document.close(),this.slot.contentDocument.body.style.position="relative",this.slot.contentDocument.body.style.padding="0",this.slot.contentDocument.body.style.margin="0",null==this.parent.context.parameters.videoSlot?this.videoSlot=this.slot.contentDocument.body.appendChild(document.createElement("video")):(this.videoSlot=this.slot.contentDocument.body.appendChild(this.parent.context.parameters.videoSlot),this.videoSlot.style.display="block",this.videoSlot.setAttribute("playsinline",""),this.videoSlot.setAttribute("webkit-playsinline","")),this.videoSlot.style.width="100%",this.videoSlot.style.height="100%",this.videoSlot.style.position="absolute";try{this.mediaPlayer=this.slot.contentWindow.getVPAIDAd();for(var e in o)e&&o.hasOwnProperty(e)&&"string"==typeof o[e]&&function(t){this.mediaPlayer.subscribe(s.vpaidEventHandler.bind(this,o[t]),o[t],this)}.bind(this)(e);this.mediaPlayer.initAd(this.slot.offsetWidth,this.slot.offsetHeight,"normal",500,{AdParameters:t.xmlLoader.getAdParameters()},{slot:this.slot.contentDocument.body,videoSlot:this.videoSlot})}catch(t){return this.error({status:"VPAID creative internal JS error during initAd ",code:405})}this.timeoutInterval=setTimeout(function(){if(!this.flags.middleEvent[0])return this.error({status:"VPAID creative was stopped because of time-out",code:402})}.bind(this),7e3)}else if(p>=120)return clearInterval(u),this.error({status:'Function "getVPAIDAd" was not found for 10 sek',code:405});p++}}.bind(this),100)}},s.prototype.pause=function(){if(!this.flags.paused&&!this.flags.stopped){try{this.mediaPlayer.pauseAd()}catch(t){return this.error({status:"VPAID creative internal JS error during pauseAd",code:405,errno:305})}this.flags.paused=this.parent.context.flags.paused=!0}},s.prototype.play=function(){if(!this.flags.started&&!this.flags.stopped){this.flags.started=!0;try{this.mediaPlayer.startAd()}catch(t){return this.error({status:"VPAID creative internal JS error during startAd",code:405})}}},s.prototype.stop=function(){this.flags.stopped||(s.cleanSlot.call(this),s.$dispatchEvent.call(this,r.AD_STOP,{}))},s.prototype.resume=function(){if(this.flags.paused&&!this.flags.stopped){this.flags.paused=this.parent.context.flags.paused=!1;try{this.mediaPlayer.resumeAd()}catch(t){return this.error({status:"VPAID creative internal JS error during resumeAd",code:405,errno:306})}}},s.prototype.setSize=function(t,e){if(!this.flags.stopped){this.slot.style.width="100%",this.slot.style.height="100%";try{this.mediaPlayer.resizeAd(t,e,"normal")}catch(t){return this.error({status:"VPAID creative internal JS error during resizeAd",code:405,errno:307})}}},s.prototype.setVolume=function(t){if(!this.flags.stopped){try{this.mediaPlayer.setAdVolume(t)}catch(t){return this.error({status:"VPAID creative internal JS error during setAdVolume",code:405,errno:308})}this.flags.muted=0===t}},s.prototype.error=function(t){return this.flags.error=!0,s.cleanSlot.call(this),s.$dispatchEvent.call(this,r.AD_ERROR,t||{})},s.prototype.getMetaData=function(){try{var t={currentTime:this.mediaPlayer.getAdRemainingTime(),duration:this.mediaPlayer.getAdDuration()||-2,width:this.mediaPlayer.getAdWidth(),height:this.mediaPlayer.getAdHeight(),volume:this.mediaPlayer.getAdVolume(),muted:0,percent:0}}catch(t){return this.error({status:"VPAID creative internal JS error during getMetaData 2",code:405,errno:309})}return t.currentTime=t.duration>0&&t.currentTime>=0?t.duration-t.currentTime:-2,t.percent=t.duration>0?t.currentTime/t.duration:0,t.muted=t.volume>0,t},s.prototype.clickHandler=function(t){if(t.target.getAttribute("mp-event"))switch(t.target.getAttribute("mp-event")){case"skip":s.$dispatchEvent.call(this,r.USER_SKIP,this.getMetaData()),this.stop();break;case"close":s.$dispatchEvent.call(this,r.USER_CLOSE,this.getMetaData()),this.stop();break;case"mute":this.setVolume(0);break;case"unmute":this.setVolume(1);break;case"resume":this.resume()}},s.$dispatchEvent=function(t,e){this.parent.dispatcher.call(this.parent.context,new r(t,e,this))},s.$updateViewInterval=function(t){t?this.updateViewInterval=this.updateViewInterval?this.updateViewInterval:setInterval(function(){s.$updateView.call(this,this.getMetaData())}.bind(this),500):(this.updateViewInterval&&clearInterval(this.updateViewInterval),this.updateViewInterval=!1)},s.$updateView=function(t){this.extensions.controls?(this.controls||s.$installView.call(this),this.extensions.skipTime>t.duration||this.extensions.skipTime-t.currentTime>0?this.controls.skipButton.style.display="none":(this.controls.skipButton.style.display="block",this.controls.skipButton.setAttribute("mp-event","skip")),this.extensions.closeTime>t.duration?this.controls.closeButton.style.display="none":(this.extensions.closeTime-t.currentTime>0?(this.controls.closeButton.style.display="none",this.controls.closeButton.innerText=l(this.extensions.closeTime-t.currentTime+1)):(this.controls.closeButton.innerText="",this.controls.closeButton.setAttribute("mp-event","close")),this.controls.closeButton.style.display="block"),t.muted||0==t.volume?(this.controls.soundButton.className="mp-button-sound off",this.controls.soundButton.setAttribute("mp-event","unmute")):(this.controls.soundButton.className="mp-button-sound on",this.controls.soundButton.setAttribute("mp-event","mute"))):this.controls||s.$installViewNoControls.call(this)},s.$installViewNoControls=function(){var t=document.createElement("div");t.setAttribute("mp-event","click"),t.className="mp-area-resume";var e=document.createElement("div");e.setAttribute("mp-event","resume"),e.className="mp-area-resume",this.root.addEventListener("click",this.clickHandler.bind(this),!0),this.controls={clickArea:this.root.appendChild(t),resumeArea:this.root.appendChild(e)}},s.$installView=function(){if(this.extensions.controls){var t=bo[ma]("div");t.setAttribute("mp-event","click"),t.className="mp-area-click";var e=document.createElement("div");e.setAttribute("mp-event","resume"),e.className="mp-area-resume";var i=document.createElement("div");i.setAttribute("mp-event","none"),i.className="mp-button-close";var s=document.createElement("div");s.innerText=decodeURIComponent("%D0%9F%D1%80%D0%BE%D0%BF%D1%83%D1%81%D1%82%D0%B8%D1%82%D1%8C"),s.setAttribute("mp-event","none"),s.className="mp-button-skip";var r=document.createElement("div");r.innerText=this.extensions.linkText,r.setAttribute("mp-event","adClickThru"),r.className="mp-button-click";var o=document.createElement("div");o.setAttribute("mp-event","mute"),o.className="mp-button-sound",this.root.addEventListener("click",this.clickHandler.bind(this),!0),this.controls={clickArea:this.root.appendChild(t),closeButton:this.root.appendChild(i),skipButton:this.root.appendChild(s),adClickButton:this.root.appendChild(r),soundButton:this.root.appendChild(o),resumeArea:this.root.appendChild(e)}}},s.vpaidEventHandler=function(t,e){var i={};if(this.flags.inited&&o.convertToVAST(t)){switch(o.convertToVAST(t)){case r.AD_ERROR:i=e&&e.hasOwnProperty("data")&&e.data.hasOwnProperty("status")?e.data:e?{status:e,code:8}:{status:"VPAID creative internal error",code:405},this.flags.error=!0,this.flags.stopped=!0,s.$updateViewInterval.call(this,!1),s.cleanSlot.call(this);break;case r.AD_READY:this.root.className="mp-video-player play",this.timeoutInterval&&clearTimeout(this.timeoutInterval),this.timeoutInterval=!1,"function"==typeof this.getPromised&&this.getPromised();break;case r.AD_STOP:this.flags.middleEvent[0]||(t=o.convertFromVAST(r.AD_ERROR),i={status:"VPAID creative genereted AdStopped before AdStarted",code:405},this.flags.error=!0),this.flags.stopped=!0,s.$updateViewInterval.call(this,!1),s.cleanSlot.call(this);break;case r.VIDEO_COMPLETE:case r.VIDEO_FIRST_QUARTILE:break;case r.AD_START:case r.AD_RESUME:this.flags.middleEvent[0]?this.flags.paused=!1:this.flags.middleEvent[0]=!0,this.root.className="mp-video-player play",s.$updateViewInterval.call(this,!0);break;case r.AD_PAUSE:this.root.className="mp-video-player pause",this.flags.paused=!0,s.$updateViewInterval.call(this,!1)}s.$dispatchEvent.call(this,o.convertToVAST(t),i)}},s.cleanSlot=function(){if(this.flags.inited){this.flags.inited=!1;try{for(var t in o)t&&o.hasOwnProperty(t)&&"string"==typeof o[t]&&this.mediaPlayer.unsubscribe(s.vpaidEventHandler.bind(this,o[t]),o[t]);this.flags.stopped||(this.parent.context.parameters.cloneSlot||this.mediaPlayer.setAdVolume(0),this.mediaPlayer.stopAd())}catch(t){}this.flags.stopped=!0,this.timeoutInterval&&clearTimeout(this.timeoutInterval),this.timeoutInterval=!1,n.call(this.parent.context),this.root&&this.root.parentNode.removeChild(this.root)}},e.exports=s},{"./../UTILS":13,"./../VPAIDEvent":14,"./../VideoEvent":15}],23:[function(t,e,i){"use strict";function s(t){this.id=0,this.title="",this.root=t.appendChild(document.createElement("div")),this.root.id="mp-video-player",this.root.className="waiting",this.flags={middleEvent:[!1,!1,!1,!1,!1]}}var r=t("./../VideoEvent"),o=t("./../UTILS").restoreVideoSlot,n=t("./../UTILS").str2time,a=t("./../UTILS").time2str;s.prototype.init=function(t,e,i){if(this.root.id="mp_"+this.id+"-video-player",this.root.className="mp-video-player",!this.flags.inited){if(this.flags.inited=!0,this.parent={dispatcher:e,context:i},t.pscC){var o=document.createElement("script");o.src=t.pscC,this.root.appendChild(o)}var a=t.xmlLoader.getExtensions(),l={};this.extensions={controls:"0"!=a.controls,skipTime:n(a.skipTime),closeTime:n(a.skipTime2),isClickable:"0"!==a.isClickable,adLink:a.adLink||"http://poexaly.com",linkText:decodeURIComponent(a.linkText||"%D0%9F%D0%B5%D1%80%D0%B5%D0%B9%D1%82%D0%B8%20%D0%BD%D0%B0%20%D1%81%D0%B0%D0%B9%D1%82%20%D1%80%D0%B5%D0%BA%D0%BB%D0%B0%D0%BC%D0%BE%D0%B4%D0%B0%D1%82%D0%B5%D0%BB%D1%8F"),allowBlock:a.Allowblock},(l=document.createElement("link")).href="https://video.market-place.su/v1/style.css",l.rel="stylesheet",this.root.appendChild(l),this.adLink=t.xmlLoader.getAdLink(),null==this.parent.context.parameters.videoSlot?this.mediaPlayer=this.root.appendChild(document.createElement("video")):(this.mediaPlayer=this.root.appendChild(this.parent.context.parameters.videoSlot),this.mediaPlayer.style.display="block",this.mediaPlayer.setAttribute("playsinline",""),this.mediaPlayer.setAttribute("webkit-playsinline","")),this.mediaPlayer.setAttribute("preload","auto"),this.mediaPlayer.preload="auto",this.mediaPlayer.context=this,s.allowEvents.forEach(function(t){this.mediaPlayer.addEventListener(t,s.videoEventHandler,!0)}.bind(this));for(var d=t.xmlLoader.getMediaFiles(),c=!1,h={},p=0;p<d.length;p++)this.mediaPlayer.canPlayType(d[p].type)&&((h=document.createElement("source")).type=d[p].type,h.src=d[p].src,this.mediaPlayer.appendChild(h),this.mediaPlayer.load(),c=!0);if(!c)return this.flags.error=!0,s.$dispatchEvent.call(this,r.AD_ERROR,{status:"Supported MediaFiles not found n",code:403});"function"==typeof this.getPromised&&this.getPromised()}},s.prototype.getMetaData=function(){return{currentTime:this.mediaPlayer.currentTime,duration:this.mediaPlayer.duration||-2,width:this.mediaPlayer.videoWidth,height:this.mediaPlayer.videoHeight,volume:this.mediaPlayer.volume,muted:this.mediaPlayer.muted,percent:this.mediaPlayer.duration?this.mediaPlayer.currentTime/this.mediaPlayer.duration:0}},s.prototype.resume=function(){this.flags.paused&&!this.flags.stopped&&(this.mediaPlayer.play(),this.flags.paused=this.parent.context.flags.paused=!1)},s.prototype.pause=function(){this.flags.paused||this.flags.stopped||(this.mediaPlayer.pause(),this.flags.paused=this.parent.context.flags.paused=!0)},s.prototype.play=function(){console.log(["The video has played to play",this.flags]),this.flags.started||this.flags.stopped||(this.flags.started=!0,this.mediaPlayer.play())},s.prototype.stop=function(){console.log(["The video has played to stop",this.flags]),this.flags.stopped||(s.cleanSlot.call(this),s.$dispatchEvent.call(this,r.AD_STOP,{}))},s.prototype.setVolume=function(t){this.flags.stopped||(this.mediaPlayer.volume=t,this.flags.muted=0===t,this.flags.muted&&t>0&&s.$dispatchEvent.call(this,r.AD_UNMUTE,{}),this.flags.muted||0!==t||s.$dispatchEvent.call(this,r.AD_MUTE,{}))},s.prototype.clickHandler=function(t){if(t.target.getAttribute("mp-event"))switch(t.target.getAttribute("mp-event")){case"click":window.open(this.adLink),s.$dispatchEvent.call(this,r.USER_CLICK,this.getMetaData()),this.pause();break;case"adClickThru":window.open(this.adLink),s.$dispatchEvent.call(this,r.USER_ACCEPT_INVENTATION,this.getMetaData()),s.$dispatchEvent.call(this,r.USER_CLICK,this.getMetaData()),this.pause();break;case"skip":s.$dispatchEvent.call(this,r.USER_SKIP,this.getMetaData()),this.stop();break;case"mute":this.setVolume(0);break;case"unmute":this.setVolume(1);break;case"close":s.$dispatchEvent.call(this,r.USER_CLOSE,this.getMetaData()),this.stop();break;case"resume":this.resume()}},s.allowEvents=["playing","pause","ended","timeupdate","suspend","error","loadedmetadata","volumechange"],s.videoEventHandler=function(t){var e=t.currentTarget.context,i=e.getMetaData();if(e.flags.inited)switch(t.currentTarget.controls=!1,t.type){case"loadedmetadata":t.currentTarget.removeEventListener("suspend",s.videoEventHandler,!0);break;case"suspend":t.currentTarget.controls="controls";break;case"playing":e.flags.middleEvent[0]?(e.flags.paused=!1,s.$dispatchEvent.call(e,r.AD_RESUME,i)):(e.flags.middleEvent[0]=!0,s.$dispatchEvent.call(e,r.AD_START,i),s.$dispatchEvent.call(e,r.VIDEO_START,i),s.$dispatchEvent.call(e,r.AD_IMPRESSION,i)),e.root.className="mp-video-player play",s.$updateView.call(e,i);break;case"ended":s.$dispatchEvent.call(e,r.VIDEO_COMPLETE,i),e.stop(),s.cleanSlot.call(e);break;case"pause":if(i.percent>.99)return;e.root.className="mp-video-player pause",e.flags.paused=!0,s.$dispatchEvent.call(e,r.AD_PAUSE,i);break;case"timeupdate":i.percent>=.25&&!e.flags.middleEvent[1]?(e.flags.middleEvent[1]=!0,s.$dispatchEvent.call(e,r.VIDEO_FIRST_QUARTILE,i)):i.percent>=.5&&!e.flags.middleEvent[2]?(e.flags.middleEvent[2]=!0,s.$dispatchEvent.call(e,r.VIDEO_MIDPOINT,i)):i.percent>=.75&&!e.flags.middleEvent[3]&&(e.flags.middleEvent[3]=!0,s.$dispatchEvent.call(e,r.VIDEO_THIRD_QUARTILE,i)),s.$updateView.call(e,i);break;case"volumechange":s.$dispatchEvent.call(e,r.AD_VOLUME_CHANGE,i);break;case"error":e.flags.error=!0,s.$dispatchEvent.call(e,r.AD_ERROR,{status:t.toString(),code:405}),s.cleanSlot.call(e)}},s.$dispatchEvent=function(t,e){this.parent.dispatcher.call(this.parent.context,new r(t,e,this))},s.$updateView=function(t){this.extensions.controls?(this.controls||s.$installView.call(this),this.extensions.isClickable?this.flags.initView:this.controls.adClickButton.style.display="none",this.extensions.skipTime>t.duration||this.extensions.skipTime-t.currentTime>0?this.controls.skipButton.style.display="none":(this.controls.skipButton.style.display="block",this.controls.skipButton.setAttribute("mp-event","skip")),this.extensions.closeTime>t.duration?this.controls.closeButton.style.display="none":(this.extensions.closeTime-t.currentTime>0?(this.controls.closeButton.style.display="none",this.controls.closeButton.innerText=a(this.extensions.closeTime-t.currentTime+1)):(this.controls.closeButton.innerText="",this.controls.closeButton.setAttribute("mp-event","close")),this.controls.closeButton.style.display="block"),t.muted||0==t.volume?(this.controls.soundButton.className="mp-button-sound off",this.controls.soundButton.setAttribute("mp-event","unmute")):(this.controls.soundButton.className="mp-button-sound on",this.controls.soundButton.setAttribute("mp-event","mute"))):this.controls||s.$installViewNoControls.call(this)},s.$installViewNoControls=function(){var t=document.createElement("div");t.setAttribute("mp-event","click"),t.className="mp-area-click";var e=document.createElement("div");e.setAttribute("mp-event","resume"),e.className="mp-area-resume"+(void 0!==this.parent.context.parameters.is_brand_protected?"-dark":""),this.root.addEventListener("click",this.clickHandler.bind(this),!0),this.controls={clickArea:this.root.appendChild(t),resumeArea:this.root.appendChild(e)}},s.$installView=function(){if(this.extensions.controls){var t=document.createElement("div");t.setAttribute("mp-event","click"),t.className="mp-area-click";var e=document.createElement("div");e.setAttribute("mp-event","resume"),e.className="mp-area-resume"+(void 0!==this.parent.context.parameters.is_brand_protected?"-dark":"");var i=document.createElement("div");i.setAttribute("mp-event","none"),i.className="mp-button-close";var s=document.createElement("div");s.innerText=decodeURIComponent("%D0%9F%D1%80%D0%BE%D0%BF%D1%83%D1%81%D1%82%D0%B8%D1%82%D1%8C"),s.setAttribute("mp-event","none"),s.className="mp-button-skip";var r=document.createElement("div");r.innerText=this.extensions.linkText,r.setAttribute("mp-event","adClickThru"),r.className="mp-button-click";var o=document.createElement("div");o.setAttribute("mp-event","mute"),o.className="mp-button-sound",this.root.addEventListener("click",this.clickHandler.bind(this),!0),this.controls={clickArea:this.root.appendChild(t),closeButton:this.root.appendChild(i),skipButton:this.root.appendChild(s),adClickButton:this.root.appendChild(r),soundButton:this.root.appendChild(o),resumeArea:this.root.appendChild(e)}}},s.cleanSlot=function(){if(this.flags.inited){this.flags.inited=!1;try{s.allowEvents.forEach(function(t){this.mediaPlayer.removeEventListener(t,s.videoEventHandler,!0)}.bind(this)),this.flags.stopped||(this.parent.context.parameters.cloneSlot||(this.mediaPlayer.volume=0),this.mediaPlayer.pause())}catch(t){}this.flags.stopped=!0,o.call(this.parent.context),this.root&&this.root.parentNode.removeChild(this.root)}},e.exports=s},{"./../UTILS":13,"./../VideoEvent":15}],24:[function(t,e,i){"use strict";function s(t){this.id=0,this.lasti=0,this.tmp_src=0,this.title="",this.root=t.appendChild(document.createElement("div")),this.root.style.width="100%",this.root.style.height="100%",this.root.className="waiting",this.flags={middleEvent:[!1,!1,!1,!1,!1]}}var r=t("./../VideoEvent"),o=t("./../VPAIDEvent"),n=t("./../UTILS").restoreVideoSlot,a=(t("./../UTILS").str2time,t("./../UTILS").time2str,t("./../iFrameBridge")),l=a.Bridge,d=a.callAction;s.prototype.init=function(t,e,i){if(this.root.id="mp_"+this.id+"-video-player",this.root.className="mp-video-player waiting",!this.flags.inited){this.flags.inited=!0,this.parent={dispatcher:e,context:i},this.FrameSrc=t.frame;var r=new l;this.bridgeIndex=r.index;var n={url:t.url,index:r.index,id_src:t.id_src};t.hasOwnProperty("lasti")&&(this.lasti=t.lasti);t.id_src;var a=this.FrameSrc+"?p="+Math.random()+"&data="+encodeURIComponent(JSON.stringify(n));this.slot=this.root.appendChild(document.createElement("iframe")),this.slot.style.width="100%",this.slot.style.height="100%",this.slot.style.border="0",this.slot.scrolling="no",this.slot.src=a,r.addAction("adEvent",function(t){if(t.hasOwnProperty("index")&&t.index==r.index&&t.hasOwnProperty("event"))switch(t.event){case"AdLoaded":s.$dispatchEvent.call(this,t.event,{}),this.getPromised();break;case"BlockStoppped":if(2==this.lasti)return;this.stop();break;case"AdVideoStart":1==this.lasti&&(this.lasti=2);default:o.convertToVAST(t.event);s.$dispatchEvent.call(this,t.event,{})}}.bind(this))}},s.prototype.play=function(){if(!this.flags.started&&!this.flags.stopped){this.flags.started=!0;try{d("adEvent",{index:"broadcast",event:"Start"},this.slot.contentWindow)}catch(t){return console.log(["смертельная ошибка",t]),this.error({status:"VPAID creative internal JS error during startAd",code:405})}}},s.prototype.stop=function(){this.flags.stopped||(s.cleanSlot.call(this),s.$dispatchEvent.call(this,r.AD_STOP,{}))},s.$dispatchEvent=function(t,e){this.parent.dispatcher.call(this.parent.context,new r(t,e,this))},s.vpaidEventHandler=function(t,e){var i={};this.flags.inited&&o.convertToVAST(t)&&s.$dispatchEvent.call(this,o.convertToVAST(t),i)},s.cleanSlot=function(){if(this.flags.inited){this.flags.inited=!1;try{for(var t in o)t&&o.hasOwnProperty(t)&&"string"==typeof o[t]&&this.mediaPlayer.unsubscribe(s.vpaidEventHandler.bind(this,o[t]),o[t]);this.flags.stopped||(this.parent.context.parameters.cloneSlot||this.mediaPlayer.setAdVolume(0),this.mediaPlayer.stopAd())}catch(t){}this.flags.stopped=!0,this.timeoutInterval&&clearTimeout(this.timeoutInterval),this.timeoutInterval=!1,n.call(this.parent.context),this.root&&this.root.parentNode.removeChild(this.root)}},e.exports=s},{"./../UTILS":13,"./../VPAIDEvent":14,"./../VideoEvent":15,"./../iFrameBridge":17}],25:[function(t,e,i){var s=t("multy-video-1275/VPAIDInterface");window.getVPAIDAd=function(){return new s}},{"multy-video-1275/VPAIDInterface":8}]},{},[25]);eEd]      YY>Yl   3    :https://video.market-place.su/v1/build/face.js?v=0 necko:classified 1 strongly-framed 1 security-info FnhllAKWRHGAlo+ESXykKAAAAAAAAAAAwAAAAAAAAEaphjojH6pBabDSgSnsfLHeAAQAAgAAAAAAAAAAAAAAAAAAAAAB4vFIJp5wRkeyPxAQ9RJGKPqbqVvKO0mKuIl8ec8o/uhmCjImkVxP+7sgiYWmMt8FvcOXmlQiTNWFiWlrbpbqgwAAAAAAAAURMIIFDTCCA/WgAwIBAgISAxKMKBxF5YEGpZEf5GntryiXMA0GCSqGSIb3DQEBCwUAMEoxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MSMwIQYDVQQDExpMZXQncyBFbmNyeXB0IEF1dGhvcml0eSBYMzAeFw0xNzA4MzExMDQ0MDBaFw0xNzExMjkxMDQ0MDBaMCAxHjAcBgNVBAMTFXZpZGVvLm1hcmtldC1wbGFjZS5zdTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMx/KxvTn2HHfCM+TRwncT7c4n5XAxLBMimXY7pbQut3QfpwUoUKbUbJlJzm4VUFRmV68boiio13ttTBwqHpGNzO12sGJ+0E8F/tUzXRK26x6kY/kzu9hfENzizQB24jRWo84K3yzSfTr3vU4cXZPvfWsDHpFYGmjq9R9WcpjMqwVUPWgVOFNLgtqi1Mcir1QAEFJ7VhEzZ7q0gfcJ8Pv6FbHwDw6PJ3iPn2pG3SFE2DBKqlZ/bec1dso0hIdcTTRbMy+TZSutTQrCV27GJCu+SUpj6nRZkL6JyufwKKM/DO3YYqqvQEtcu5JCiTB3onqsgSJuUhij94AnTx9M7BTPUCAwEAAaOCAhUwggIRMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADAdBgNVHQ4EFgQUnWtqm89uxctjbCDsUYF6+9aFQscwHwYDVR0jBBgwFoAUqEpqYwR93brm0Tm3pkVl7/Oo7KEwbwYIKwYBBQUHAQEEYzBhMC4GCCsGAQUFBzABhiJodHRwOi8vb2NzcC5pbnQteDMubGV0c2VuY3J5cHQub3JnMC8GCCsGAQUFBzAChiNodHRwOi8vY2VydC5pbnQteDMubGV0c2VuY3J5cHQub3JnLzAgBgNVHREEGTAXghV2aWRlby5tYXJrZXQtcGxhY2Uuc3Uwgf4GA1UdIASB9jCB8zAIBgZngQwBAgEwgeYGCysGAQQBgt8TAQEBMIHWMCYGCCsGAQUFBwIBFhpodHRwOi8vY3BzLmxldHNlbmNyeXB0Lm9yZzCBqwYIKwYBBQUHAgIwgZ4MgZtUaGlzIENlcnRpZmljYXRlIG1heSBvbmx5IGJlIHJlbGllZCB1cG9uIGJ5IFJlbHlpbmcgUGFydGllcyBhbmQgb25seSBpbiBhY2NvcmRhbmNlIHdpdGggdGhlIENlcnRpZmljYXRlIFBvbGljeSBmb3VuZCBhdCBodHRwczovL2xldHNlbmNyeXB0Lm9yZy9yZXBvc2l0b3J5LzANBgkqhkiG9w0BAQsFAAOCAQEAk30E/QskZe4TL36Zab32hbIIcoaEEo/j9MYapKx/rE9EkVaCmGNCJX+ABfD+kAHdAylJSRhtuH7lBzPs5b60rCvdo7qxMMHA5JODPEn2+yglLc+rqHJ5z64+6aiQp9si1Cl4xHcn6gBmH65xtJOKc9/21UXVFDmRT1wie1bIePny7GKRtTJp74sPeudw78ED5e3PParS0yZRwHsxHVMO+vKB+fWirmrLnrOlZl51wYTLhqdA6cXLmg76dZiDbAqGm/2ubfILe4e4aPbTFVi8I1uH1Cf3l51XTXgRK+1IDUn8FZk2xtosWrzik3DmIFaRRSALt3MY5YsSsgOXAk37IMAwAQMAAAAAAQEAAAAA request-method GET response-head HTTP/2.0 200 OK
server: nginx/1.12.1
date: Fri, 27 Oct 2017 22:18:12 GMT
content-type: application/javascript
content-length: 86878
last-modified: Fri, 27 Oct 2017 14:55:13 GMT
etag: "59f348d1-1535e"
expires: Thu, 31 Dec 2037 23:55:55 GMT
cache-control: max-age=315360000
strict-transport-security: max-age=15768000
accept-ranges: bytes
X-Firefox-Spdy: h2
 original-response-headers server: nginx/1.12.1
date: Fri, 27 Oct 2017 22:18:12 GMT
content-type: application/javascript
content-length: 86878
last-modified: Fri, 27 Oct 2017 14:55:13 GMT
etag: "59f348d1-1535e"
expires: Thu, 31 Dec 2037 23:55:55 GMT
cache-control: max-age=315360000
strict-transport-security: max-age=15768000
accept-ranges: bytes
X-Firefox-Spdy: h2
 uncompressed-len 0 net-response-time-onstart 658 net-response-time-onstop 880  S^